<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Night Games • v552</title>

<!-- Firebase compat (single-file web build) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
/* ============================================================
   Night Games v552 — FULL BUILD (single-file; text-file friendly)
   ============================================================
   How to use:
   - Save as index.html (or rename this text file to index.html)
   - Place in your repo root alongside these assets (NOT embedded):
       7F737C26-56A1-497B-A4A2-CCD6141E7B8C.png?v=495   (banner game design)
       7F737C26-56A1-497B-A4A2-CCD6141E7B8C.png?v=495 (fallback banner)
       0217.mp4?v=495 (optional sweep overlay; if missing it will skip)
       MY DART AVATAR.png (optional)
       WILLIAM DART AVATAR.png (optional)
       MY DART AVATAR.png (optional)
   ------------------------------------------------------------
   What this build includes:
   - Email-only sign-in
   - New user => asks name once (modal)
   - Player page with big name top, speaker, sign out
   - Neon / glow night theme across ALL screens
   - Banner across top (game design image)
   - Footer disclosure across bottom on ALL screens
   - Players list with online green dot (presence pings)
   - Games: Cricket + 01 basic playable turn loop (per-turn entry)
   - Other games: placeholder screens (navigable)
   - Online matches WITHOUT codes:
       "Open Matches" list (create match; others can tap to join)
   ============================================================ */

:root{
  --bg0:#05070a; --bg1:#070a10;
  --panel:rgba(10,12,16,.80);
  --panel2:rgba(0,0,0,.28);
  --stroke:rgba(120,180,255,.18);
  --stroke2:rgba(0,215,255,.30);
  --text:#e9f2ff; --muted:rgba(233,242,255,.72);
  --cyan:#00d7ff; --blue:#2a7fff;
  --green:#2ee66b; --danger:#ff4d4d; --amber:#ffb000;
  --shadow:0 18px 42px rgba(0,0,0,.55);
  --r:18px;
  --btnR:16px;
}

html,body{height:100%;margin:0;color:var(--text);
  background:
    radial-gradient(120% 120% at 18% 12%, rgba(0,215,255,.18), rgba(0,0,0,0) 54%),
    radial-gradient(120% 120% at 85% 78%, rgba(42,127,255,.14), rgba(0,0,0,0) 56%),
    linear-gradient(180deg,var(--bg1),var(--bg0));
  font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
}


/* --- v552 Skin: pull colors from the banner asset (repo) --- */
body::before{
  content:"";
  position:fixed; inset:-20%;
  background-image:url('7F737C26-56A1-497B-A4A2-CCD6141E7B8C.png?v=496');
  background-size:cover; background-position:center;
  filter: blur(28px) saturate(1.15) contrast(1.08);
  opacity:.12;
  transform:scale(1.08);
  pointer-events:none;
  z-index:-2;
}
body::after{
  content:"";
  position:fixed; inset:0;
  background:
    radial-gradient(120% 120% at 18% 12%, rgba(0,215,255,.20), rgba(0,0,0,0) 54%),
    radial-gradient(120% 120% at 85% 78%, rgba(42,127,255,.18), rgba(0,0,0,0) 56%),
    linear-gradient(180deg, rgba(0,0,0,.40), rgba(0,0,0,.72));
  pointer-events:none;
  z-index:-1;
}
/* extra glow / bevel */
.btn{
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.26));
}
.btn::after{
  box-shadow:
    0 0 0 1px rgba(255,255,255,.08) inset,
    0 10px 24px rgba(0,0,0,.42),
    0 0 26px rgba(0,215,255,.16);
}
.btn.green::after{
  box-shadow:
    0 0 0 1px rgba(255,255,255,.10) inset,
    0 10px 24px rgba(0,0,0,.42),
    0 0 28px rgba(46,230,107,.22);
}
.panel{
  box-shadow:0 16px 36px rgba(0,0,0,.35), 0 0 22px rgba(0,215,255,.06);

  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}


/* --- v552 Landing Color Scheme --- */
.heroHeader{
  border-bottom:1px solid rgba(120,180,255,.16);
  background:
    radial-gradient(120% 140% at 12% 10%, rgba(0,215,255,.22), rgba(0,0,0,0) 55%),
    radial-gradient(120% 140% at 88% 65%, rgba(255,173,0,.16), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, rgba(0,0,0,.15), rgba(0,0,0,.35));
}
.heroInner{padding:18px 14px 14px 14px;text-align:center;}
.heroLogo{
  width:min(860px,100%);
  max-height:260px;
  object-fit:contain;
  filter:drop-shadow(0 26px 46px rgba(0,0,0,.62)) drop-shadow(0 0 18px rgba(0,215,255,.22));
}
.heroTitle{
  margin-top:10px;
  font-size:28px;
  font-weight:1000;
  letter-spacing:.25px;
  text-shadow:0 0 18px rgba(0,215,255,.18);
}
.heroSub{color:rgba(233,242,255,.75);font-size:13px;margin-top:4px;}
.heroPanel{
  max-width:640px;
  margin:0 auto;
  background:
    radial-gradient(120% 120% at 15% 15%, rgba(0,215,255,.10), rgba(0,0,0,0) 55%),
    rgba(0,0,0,.28);
  border:1px solid rgba(0,215,255,.18);
  box-shadow:0 18px 44px rgba(0,0,0,.42), 0 0 26px rgba(0,215,255,.08);

  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  padding: 0 !important;
  backdrop-filter: none !important;
}
.input{
  border:1px solid rgba(0,215,255,.22);
  box-shadow:0 0 0 1px rgba(255,255,255,.04) inset, 0 0 22px rgba(0,215,255,.06);
}


/* --- v552: Night Games neon theme (match logo colors) --- */
:root{
  --cBlue: rgba(0,215,255,.26);
  --cBlue2: rgba(42,127,255,.20);
  --cOrange: rgba(255,173,0,.22);
  --cOrange2: rgba(255,120,35,.14);
}
body::before{
  content:"";
  position:fixed; inset:-20%;
  background-image:url('./7F737C26-56A1-497B-A4A2-CCD6141E7B8C.png');
  background-size:cover; background-position:center;
  filter: blur(34px) saturate(1.2) contrast(1.08);
  opacity:.12;
  transform:scale(1.08);
  pointer-events:none;
  z-index:-2;
}
body::after{
  content:"";
  position:fixed; inset:0;
  background:
    radial-gradient(120% 120% at 18% 12%, var(--cBlue), rgba(0,0,0,0) 54%),
    radial-gradient(120% 120% at 82% 18%, var(--cOrange), rgba(0,0,0,0) 56%),
    radial-gradient(120% 120% at 86% 78%, var(--cBlue2), rgba(0,0,0,0) 56%),
    radial-gradient(120% 120% at 14% 78%, var(--cOrange2), rgba(0,0,0,0) 58%),
    linear-gradient(180deg, rgba(0,0,0,.42), rgba(0,0,0,.78));
  pointer-events:none;
  z-index:-1;
}
.heroHeader{
  border-bottom:1px solid rgba(120,180,255,.18);
  background:
    radial-gradient(120% 140% at 12% 10%, rgba(0,215,255,.26), rgba(0,0,0,0) 55%),
    radial-gradient(120% 140% at 88% 35%, rgba(255,173,0,.22), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, rgba(0,0,0,.08), rgba(0,0,0,.34));
}
.heroInner{padding:18px 14px 14px 14px;text-align:center;}
.heroLogo{
  width:min(860px,100%);
  max-height:260px;
  object-fit:contain;
  filter:drop-shadow(0 26px 46px rgba(0,0,0,.62))
         drop-shadow(0 0 24px rgba(0,215,255,.24))
         drop-shadow(0 0 20px rgba(255,173,0,.16));
}
.heroSub{color:rgba(233,242,255,.78);font-size:13px;margin-top:6px;}
.heroPanel{
  max-width:640px;
  margin:0 auto;
  background:
    radial-gradient(120% 120% at 15% 15%, rgba(0,215,255,.12), rgba(0,0,0,0) 55%),
    radial-gradient(120% 120% at 85% 35%, rgba(255,173,0,.10), rgba(0,0,0,0) 60%),
    rgba(0,0,0,.28);
  border:1px solid rgba(0,215,255,.20);
  box-shadow:0 18px 44px rgba(0,0,0,.44), 0 0 30px rgba(0,215,255,.10);
}
.input{
  border:1px solid rgba(0,215,255,.26);
  box-shadow:0 0 0 1px rgba(255,255,255,.04) inset, 0 0 26px rgba(0,215,255,.10);
}
.btn::after{
  box-shadow:
    0 0 0 1px rgba(255,255,255,.09) inset,
    0 10px 24px rgba(0,0,0,.46),
    0 0 30px rgba(0,215,255,.18);
}
.btn.green::after{
  box-shadow:
    0 0 0 1px rgba(255,255,255,.10) inset,
    0 10px 24px rgba(0,0,0,.46),
    0 0 34px rgba(46,230,107,.22),
    0 0 16px rgba(255,173,0,.10);
}

/* Sweep overlay (MP4) */
#sweepOverlay{
  position:fixed;
  inset:0;
  display:none;
  align-items:center;
  justify-content:center;
  pointer-events:none;
  z-index:9999;
}
#sweepOverlay.show{display:flex;}
#sweepVideo{
  width:min(560px, 78vw);
  height:auto;
  transform:rotate(-45deg);
  opacity:0;
  filter:drop-shadow(0 26px 46px rgba(0,0,0,.65))
         drop-shadow(0 0 18px rgba(0,215,255,.22))
         drop-shadow(0 0 14px rgba(255,173,0,.14));
}
#sweepOverlay.run #sweepVideo{animation:sweepOnce 1.35s ease-in-out forwards;}
@keyframes sweepOnce{
  0%{opacity:0; transform:translate(-18vw, 10vw) rotate(-45deg) scale(.96);}
  18%{opacity:1;}
  65%{opacity:1; transform:translate(0,0) rotate(-45deg) scale(1.0);}
  100%{opacity:0; transform:translate(18vw, -10vw) rotate(-45deg) scale(1.02);}
}

*{box-sizing:border-box}
a{color:var(--cyan);text-decoration:none}
.wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:16px;}
.card{width:min(980px,100%);background:var(--panel);border:1px solid var(--stroke);
  border-radius:var(--r);box-shadow:var(--shadow);backdrop-filter:blur(10px);overflow:hidden;

  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}
.main{padding:14px;}
.grid{display:grid;grid-template-columns:1fr;gap:12px;}
@media (min-width:860px){.grid{grid-template-columns:1fr 1fr;}}

.header{position:relative;border-bottom:1px solid rgba(120,180,255,.14);
  background:
    radial-gradient(120% 120% at 20% 20%, rgba(0,215,255,.16), rgba(0,0,0,0) 55%),
    radial-gradient(120% 120% at 90% 10%, rgba(42,127,255,.14), rgba(0,0,0,0) 55%),
    linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,.20));
}
.banner{width:100%;height:min(220px, 34vh);object-fit:cover;display:block;
  filter: drop-shadow(0 18px 34px rgba(0,0,0,.55)) saturate(1.10) contrast(1.06);
}
.bannerShade{position:absolute;inset:0;pointer-events:none;
  background:linear-gradient(180deg, rgba(0,0,0,.02), rgba(0,0,0,.58));
}
.titleRow{position:absolute;left:14px;right:14px;bottom:12px;
  display:flex;align-items:flex-end;justify-content:space-between;gap:10px;flex-wrap:wrap;
}
.h1{font-size:26px;font-weight:1000;letter-spacing:.2px;text-shadow:0 10px 30px rgba(0,0,0,.85);}
.badge{padding:8px 10px;border-radius:999px;border:1px solid rgba(0,215,255,.35);
  background:rgba(0,0,0,.35);
  box-shadow:0 0 0 3px rgba(0,215,255,.08), 0 18px 40px rgba(0,0,0,.45);
  font-weight:900;
}

.sub{color:var(--muted);font-size:13px;line-height:1.35;}
.h2{font-size:16px;font-weight:1000;opacity:.95;margin:0}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
.row.space{justify-content:space-between;}
.col{display:flex;flex-direction:column;gap:10px;}

.panel{border:1px solid rgba(120,180,255,.14);background:rgba(0,0,0,.22);border-radius:16px;padding:12px;}
.input{width:100%;padding:12px;border-radius:14px;border:1px solid rgba(120,180,255,.22);
  background:rgba(0,0,0,.35);color:var(--text);outline:none;
}
.input:focus{border-color:rgba(0,215,255,.55);box-shadow:0 0 0 3px rgba(0,215,255,.12);}

.btn{width:100%;padding:12px;border-radius:999px;border:1px solid rgba(120,180,255,.22);
  background:linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.18));
  color:var(--text);font-weight:900;letter-spacing:.2px;cursor:pointer;position:relative;
}
.btn::after{content:"";position:absolute;inset:0;border-radius:var(--btnR);
  box-shadow:0 0 0 1px rgba(255,255,255,.05) inset, 0 12px 28px rgba(0,0,0,.38), 0 0 18px rgba(0,215,255,.12);
  pointer-events:none;
}
.btn:hover{border-color:rgba(0,215,255,.45);}
.btn.green{background:linear-gradient(180deg, rgba(46,230,107,.18), rgba(0,0,0,.18));
  border-color:rgba(46,230,107,.45);
}
.btn.danger{background:linear-gradient(180deg, rgba(255,77,77,.14), rgba(0,0,0,.18));
  border-color:rgba(255,77,77,.40);
}
.btn.sm{width:auto;padding:8px 12px;border-radius:999px;font-size:12px;}
.btn.inline{width:auto}
.btn[disabled]{opacity:.55;pointer-events:none;}

.pulse{animation:pulseGlow 1.15s ease-in-out infinite;}
@keyframes pulseGlow{
  0%{box-shadow:0 0 0 0 rgba(46,230,107,.0);}
  50%{box-shadow:0 0 0 4px rgba(46,230,107,.10),0 0 24px rgba(46,230,107,.20);}
  100%{box-shadow:0 0 0 0 rgba(46,230,107,.0);}
}

.topbar{display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:wrap;
  padding:10px 12px;border:1px solid rgba(120,180,255,.14);background:rgba(0,0,0,.18);
  border-radius:16px;
}
.bigName{font-size:22px;font-weight:1000;letter-spacing:.2px;text-shadow:0 10px 30px rgba(0,0,0,.65);}

.list{display:flex;flex-direction:column;gap:10px;}
.playerRow{display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:10px;border-radius:16px;border:1px solid rgba(120,180,255,.14);background:rgba(0,0,0,.22);
}
.left{display:flex;align-items:center;gap:10px;min-width:0;}
.dot{width:10px;height:10px;border-radius:50%;background:rgba(233,242,255,.20);}
.dot.on{background:var(--green);box-shadow:0 0 14px rgba(46,230,107,.55);}
.nameWithAvatar{display:flex;align-items:center;gap:10px;min-width:0;}
.nameWithAvatar img{width:26px;height:26px;border-radius:8px;object-fit:cover;box-shadow:0 6px 16px rgba(0,0,0,.35);}
.pmeta{min-width:0;}
.pname{font-weight:1000;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.pemail{font-size:12px;color:var(--muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}

.chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;
  border:1px solid rgba(120,180,255,.18);background:rgba(0,0,0,.25);font-weight:900;font-size:12px;
}
.lock{padding:10px;border-radius:16px;border:1px solid rgba(255,176,0,.35);background:rgba(255,176,0,.08);}
.ok{padding:10px;border-radius:16px;border:1px solid rgba(46,230,107,.35);background:rgba(46,230,107,.06);}

.table{width:100%;border-collapse:collapse;font-size:13px;}
.table th,.table td{padding:8px 6px;border-bottom:1px solid rgba(120,180,255,.12);text-align:left;}
.table th{color:rgba(233,242,255,.85);font-weight:1000;}

.footer{padding:10px 12px;border-top:1px solid rgba(120,180,255,.14);
  background:rgba(0,0,0,.28);color:rgba(233,242,255,.78);
  font-size:12px;line-height:1.35;text-align:center;
}
.footer b{color:#e9f2ff;}


.cards{display:grid;grid-template-columns:1fr;gap:12px;}
@media (min-width:860px){.cards{grid-template-columns:1fr 1fr;}}
.gcard{border:1px solid rgba(120,180,255,.14);background:rgba(0,0,0,.20);border-radius:18px;padding:12px;
  box-shadow:0 12px 26px rgba(0,0,0,.26), 0 0 22px rgba(0,215,255,.05);
}
.gtitle{font-weight:1000;font-size:16px;letter-spacing:.2px;}
.gsub{color:var(--muted);font-size:12px;margin-top:2px;}
.grow{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:10px;}
@media (max-width:520px){.grow{grid-template-columns:1fr;}}

@media (min-width:860px){.gameGrid{grid-template-columns:repeat(2,1fr);}}
.btn.neon{border-color:rgba(0,215,255,.42);background:linear-gradient(180deg, rgba(0,215,255,.12), rgba(0,0,0,.18));}
.btn.neon:hover{box-shadow:0 0 0 4px rgba(0,215,255,.10), 0 0 26px rgba(0,215,255,.18);}
.smallList .playerRow{padding:9px;}
.smallList .pemail{display:none;}

/* Modal */
#modalBg{position:fixed;inset:0;background:rgba(0,0,0,.55);display:none;z-index:999998;}
#modalBg.show{display:block;}
#modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);
  width:min(560px,calc(100% - 28px));
  background:rgba(10,12,16,.92);border:1px solid rgba(120,180,255,.22);
  border-radius:18px;box-shadow:0 24px 60px rgba(0,0,0,.65);padding:14px;display:none;z-index:999999;
}
#modal.show{display:block;}
.modalTitle{font-size:16px;font-weight:1000;}
.modalBody{margin-top:8px;}
.modalActions{display:flex;gap:10px;justify-content:flex-end;margin-top:12px;flex-wrap:wrap;}

/* Sweep overlay (MP4 one-time) */
#sweepOverlay{position:fixed;inset:0;z-index:999999;pointer-events:none;display:none;}
#sweepOverlay.show{display:block;}
#sweepVideo{position:absolute;inset:-25% -35%;width:170%;height:170%;object-fit:cover;
  transform:translateX(-120%) translateY(18%) rotate(-18deg);opacity:0;mix-blend-mode:screen;
  filter:brightness(1.05) contrast(1.05) saturate(1.1);
}
#sweepOverlay.run #sweepVideo{opacity:.95;animation:sweepOnce 1.65s ease-out forwards;}
@keyframes sweepOnce{
  0%{transform:translateX(-120%) translateY(18%) rotate(-18deg);opacity:0;}
  10%{opacity:.95;}
  85%{opacity:.95;}
  100%{transform:translateX(120%) translateY(-18%) rotate(-18deg);opacity:0;}
}


#errBox{position:fixed;left:12px;right:12px;bottom:12px;z-index:9999;
  background:rgba(20,0,0,.92);border:1px solid rgba(255,80,80,.5);
  border-radius:14px;padding:12px;display:none;color:#ffd7d7;
  box-shadow:0 16px 40px rgba(0,0,0,.55), 0 0 22px rgba(255,80,80,.18);
  font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,'Liberation Mono','Courier New',monospace;
  font-size:12px;white-space:pre-wrap;
}
#errBox b{font-family:inherit;}

/* --- v552 LANDING VISUALS (OBVIOUS CHANGES) --- */
body{background:#000 !important;}
/* Outer screen border (neon, NOT green) */
.card{
  border:1px solid rgba(0,0,0,0) !important;
  box-shadow:
    0 18px 55px rgba(0,0,0,.55),
    0 0 0 2px rgba(130,110,255,.30),
    0 0 26px rgba(0,215,255,.12),
    0 0 18px rgba(255,173,0,.10) !important;
}
/* Top canvas is full-width black, no frame */
.heroCanvas{
  background:#000;
  padding:0;
}
.heroLogo{
  width:100%;
  max-width:980px;
  max-height:520px;
  object-fit:cover;
  display:block;
  margin:0 auto;
  filter:drop-shadow(0 18px 38px rgba(0,0,0,.72))
         drop-shadow(0 0 24px rgba(0,215,255,.22))
         drop-shadow(0 0 18px rgba(255,173,0,.14));
}
/* Sign-in segment neon border */
.heroPanel{
  border:1px solid rgba(130,110,255,.30) !important;
  box-shadow:0 12px 34px rgba(0,0,0,.55), 0 0 22px rgba(0,215,255,.10), 0 0 14px rgba(255,173,0,.08) !important;
}
/* Theme text */
.h2{color:rgba(210,220,255,.96) !important;}
.sub{color:rgba(230,236,255,.75) !important;}
/* Neon Enter button */
.btn.neon{
  background:linear-gradient(180deg, rgba(130,110,255,.32), rgba(0,0,0,.35));
  border:1px solid rgba(0,215,255,.26);
}
.btn.neon::after{
  box-shadow:
    0 0 0 1px rgba(255,255,255,.10) inset,
    0 10px 24px rgba(0,0,0,.46),
    0 0 34px rgba(0,215,255,.18),
    0 0 16px rgba(255,173,0,.10);
}
/* MP4 overlay */
#sweepOverlay{
  position:fixed; inset:0; display:none; align-items:center; justify-content:center;
  pointer-events:none; z-index:9999;
}
#sweepOverlay.show{display:flex;}
#sweepVideo{
  width:min(520px, 80vw);
  height:auto;
  transform:rotate(-45deg);
  opacity:0;
  filter:drop-shadow(0 26px 46px rgba(0,0,0,.65))
         drop-shadow(0 0 18px rgba(0,215,255,.22))
         drop-shadow(0 0 14px rgba(255,173,0,.14));
}
#sweepOverlay.run #sweepVideo{animation:sweepOnce 1.1s ease-in-out forwards;}
@keyframes sweepOnce{
  0%{opacity:0; transform:translate(-18vw, 10vw) rotate(-45deg) scale(.96);}
  18%{opacity:1;}
  70%{opacity:1; transform:translate(0,0) rotate(-45deg) scale(1.0);}
  100%{opacity:0; transform:translate(18vw, -10vw) rotate(-45deg) scale(1.02);}
}

/* ===== v552: REMOVE GREEN FRAME / SIMPLE BLACK CANVAS ===== */
html,body{background:#000 !important;}
/* Outer display: ONE neon border only */
.card{
  background:rgba(0,0,0,.88) !important;
  border:none !important;
  box-shadow:
    0 18px 55px rgba(0,0,0,.68),
    0 0 0 2px rgba(150,110,255,.32),  /* neon border */
    0 0 26px rgba(0,215,255,.10),
    0 0 18px rgba(255,120,35,.08) !important;
}
/* Top area: pure black canvas (no inner borders) */
.heroHeader{border:none !important; background:transparent !important; box-shadow:none !important;}
.heroInner{padding:0 !important;}
/* Logo BIG */
.heroLogo{
  width:100% !important;
  max-width:980px !important;
  max-height:560px !important;
  object-fit:cover !important;
  margin:0 auto !important;
  display:block !important;
  filter:
    drop-shadow(0 16px 40px rgba(0,0,0,.74))
    drop-shadow(0 0 22px rgba(0,215,255,.18))
    drop-shadow(0 0 18px rgba(255,120,35,.10)) !important;
}
/* Sign-in segment: its own neon border */
.heroPanel{
  border:1px solid rgba(150,110,255,.34) !important;
  box-shadow:
    0 14px 40px rgba(0,0,0,.58),
    0 0 22px rgba(0,215,255,.10),
    0 0 16px rgba(255,120,35,.07) !important;
}
/* Strong neon wash (not green) */
body::after{
  content:"";
  position:fixed; inset:0;
  background:
    radial-gradient(140% 140% at 16% 12%, rgba(0,215,255,.18), rgba(0,0,0,0) 58%),
    radial-gradient(140% 140% at 84% 14%, rgba(255,120,35,.16), rgba(0,0,0,0) 60%),
    radial-gradient(140% 140% at 82% 86%, rgba(150,110,255,.16), rgba(0,0,0,0) 62%),
    linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.88));
  pointer-events:none;
  z-index:-1;
}
/* Reduce green glow on the button to avoid "green frame" vibe */
.btn.green::after{
  box-shadow:
    0 0 0 1px rgba(255,255,255,.10) inset,
    0 10px 24px rgba(0,0,0,.42),
    0 0 14px rgba(0,215,255,.10),
    0 0 10px rgba(255,120,35,.06) !important;
}

/* ===== v552 MINIMAL BLACK CANVAS ===== */

/* Pure black everywhere */
html,body{
  background:#000 !important;
}

/* Remove ALL outer borders/glows */
.card{
  background:#000 !important;
  border:none !important;
  box-shadow:none !important;
}

/* Remove segment borders */
.heroPanel{
  border:none !important;
  box-shadow:none !important;
}

/* Big logo */
.heroLogo{
  width:100% !important;
  max-width:1100px !important;
  max-height:620px !important;
  object-fit:cover !important;
  margin:0 auto 20px auto !important;
  display:block !important;
}

/* Spread layout slightly */
.main{
  padding:40px 20px !important;
}

/* Change button to yellow */
.btn.green{
  background:#ffb000 !important;
  border-color:#ffb000 !important;
  color:#000 !important;
}

/* Remove green glow */
.btn.green::after{
  box-shadow:none !important;
}

/* Make "Night Games" match logo NIGHT style */
.heroSub, .header .h1{
  background:
    linear-gradient(180deg, rgba(255,255,255,.35), rgba(255,255,255,0) 55%),
    linear-gradient(180deg, #8ff6ff 0%, #00d7ff 35%, #2a7fff 75%, #0040ff 100%);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent !important;
  text-shadow:
    0 0 12px rgba(0,215,255,.55),
    0 0 28px rgba(0,215,255,.35),
    0 0 45px rgba(42,127,255,.25);
  position:relative;
}
.heroSub::after, .header .h1::after{
  content:"";
  position:absolute;
  inset:-2px;
  background-image:radial-gradient(rgba(255,255,255,.45) 1px, transparent 1px);
  background-size:7px 7px;
  opacity:.10;
  pointer-events:none;
}

/* Make Sign In green */
.h2{
  color:#2ee66b !important;
}

/* Remove background neon wash */
body::after{
  display:none !important;
}

/* ===== v552: blended background + keep blue outline on sign-in ===== */

/* Blend the black canvas subtly so it doesn't look like a hard flat slab */
html,body{
  background:
    radial-gradient(120% 120% at 20% 10%, rgba(0,215,255,.06), rgba(0,0,0,0) 55%),
    radial-gradient(120% 120% at 80% 20%, rgba(255,176,0,.05), rgba(0,0,0,0) 60%),
    linear-gradient(180deg, #000 0%, #02020a 55%, #000 100%) !important;
}

/* Keep the overall app minimal: no outer borders */
.card{
  background:transparent !important;
  border:none !important;
  box-shadow:none !important;
}

/* Keep a clean blue outline around ONLY the sign-in segment */
.heroPanel{
  border:1px solid rgba(0,215,255,.38) !important;
  border-radius:16px !important;
  background:rgba(0,0,0,.55) !important;
  box-shadow:
    0 14px 40px rgba(0,0,0,.55),
    0 0 18px rgba(0,215,255,.10) !important;
}

/* Make the logo area feel like one canvas (no edge lines) */
.heroHeader, .heroInner{
  background:transparent !important;
  border:none !important;
  box-shadow:none !important;
}

/* Preserve your color choices */
.btn.green{
  background:#ffb000 !important;
  border-color:#ffb000 !important;
  color:#000 !important;
}
.btn.green::after{ box-shadow:none !important; }

/* "Night Games" blue + "Sign in" green */
.heroSub, .header .h1{ color:#00d7ff !important; }
.h2{ color:#2ee66b !important; }

/* Keep it readable */
.sub{ color:rgba(235,240,255,.70) !important; }

/* ===== v552 THEME PASS (no green glow, blended logo, new fonts, open layout) ===== */

/* Kill any green glow remnants */
.btn.green::after{ box-shadow:none !important; }
:root{ --killGreen: rgba(46,230,107,0) !important; }

/* Global font refresh (clean, punchy) */
body{
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif !important;
}
.titleStack{
  font-family: Impact, Haettenschweiler, "Arial Black", "Franklin Gothic Heavy", sans-serif !important;
  letter-spacing: 2px;
}

/* Background: black with blue+gold only (no green/teal) */
html,body{
  background:
    radial-gradient(140% 140% at 18% 10%, rgba(0,215,255,.10), rgba(0,0,0,0) 55%),
    radial-gradient(140% 140% at 82% 18%, rgba(255,176,0,.09), rgba(0,0,0,0) 60%),
    radial-gradient(140% 140% at 75% 90%, rgba(255,120,35,.06), rgba(0,0,0,0) 62%),
    linear-gradient(180deg, #000 0%, #02010a 55%, #000 100%) !important;
}
body::after{ display:none !important; } /* remove earlier wash layers so we control colors */

/* Hero logo: blend into background (fade edges) */
.heroCanvas{
  padding: 18px 14px 0 14px !important;
  background: transparent !important;
}
.heroLogo{
  width: min(980px, 100%) !important;
  max-height: 320px !important;
  object-fit: contain !important;
  display:block !important;
  margin: 0 auto !important;
  filter:
    drop-shadow(0 18px 42px rgba(0,0,0,.70))
    drop-shadow(0 0 18px rgba(0,215,255,.14))
    drop-shadow(0 0 14px rgba(255,176,0,.10)) !important;
  -webkit-mask-image: radial-gradient(120% 120% at 50% 35%, rgba(0,0,0,1) 62%, rgba(0,0,0,.35) 82%, rgba(0,0,0,0) 100%);
  mask-image: radial-gradient(120% 120% at 50% 35%, rgba(0,0,0,1) 62%, rgba(0,0,0,.35) 82%, rgba(0,0,0,0) 100%);
}

/* Title: NIGHT blue, GAMES gold gradient (stacked) */
.heroText{ text-align:center; margin-top: 6px; }
.titleNight{
  font-size: 44px;
  line-height: 44px;
  background: linear-gradient(180deg, #9fe8ff 0%, #00d7ff 45%, #1d5bff 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: 0 0 22px rgba(0,215,255,.20);
}
.titleGames{
  font-size: 46px;
  line-height: 46px;
  margin-top: -2px;
  background: linear-gradient(180deg, #ffe08a 0%, #ffb000 55%, #ff7a18 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: 0 0 20px rgba(255,176,0,.16);
}
.heroSub{
  color: rgba(233,242,255,.70) !important;
  margin-top: 6px !important;
}

/* OPEN sign-in area: no panel border */
.heroPanel{
  border:none !important;
  background: rgba(0,0,0,.25) !important;
  box-shadow: 0 16px 44px rgba(0,0,0,.55) !important;
  max-width: 680px !important;
}

/* Only the email input gets a blue outline */
.inputBlue{
  border: 1px solid rgba(0,215,255,.38) !important;
  box-shadow:
    0 0 0 1px rgba(255,255,255,.05) inset,
    0 0 18px rgba(0,215,255,.10) !important;
}
.inputBlue:focus{
  border-color: rgba(0,215,255,.55) !important;
  box-shadow:
    0 0 0 1px rgba(255,255,255,.06) inset,
    0 0 22px rgba(0,215,255,.14),
    0 0 12px rgba(255,176,0,.08) !important;
}

/* Enter button: gold gradient + subtle glints */
.btn.goldGrad{
  border:none !important;
  color:#090909 !important;
  background: linear-gradient(180deg, #ffe08a 0%, #ffb000 55%, #ff7a18 100%) !important;
}
.btn.goldGrad::after{
  box-shadow:
    0 0 0 1px rgba(255,255,255,.18) inset,
    0 14px 28px rgba(0,0,0,.45),
    0 0 22px rgba(255,176,0,.14),
    0 0 14px rgba(0,215,255,.08) !important;
}

/* Accent bar under Enter: match logo border (gold/orange) with spark hits */
.accentBar{
  margin-top: 12px;
  height: 14px;
  border-radius: 999px;
  background:
    radial-gradient(10px 10px at 18% 50%, rgba(255,255,255,.95), rgba(255,255,255,0) 60%),
    radial-gradient(8px 8px at 62% 45%, rgba(255,255,255,.85), rgba(255,255,255,0) 60%),
    radial-gradient(8px 8px at 84% 58%, rgba(255,255,255,.75), rgba(255,255,255,0) 60%),
    linear-gradient(90deg, rgba(255,120,35,.55), rgba(255,176,0,.75), rgba(255,120,35,.55));
  box-shadow:
    0 0 0 1px rgba(255,176,0,.35) inset,
    0 0 18px rgba(255,176,0,.18),
    0 0 10px rgba(0,215,255,.10);
  opacity: .92;
}

/* Make sure "Sign in" matches dart flight green but without green glow borders */
.h2{
  color: #2ee66b !important;
  text-shadow: 0 0 14px rgba(46,230,107,.12) !important;
}

/* ===== v552: STRIPPED LANDING (NO FRAMES / NO EXTRA BORDERS) ===== */
html,body{background:#000 !important;}
body::before, body::after{display:none !important;}
.wrap{padding:0 !important;}
/* Remove any "frame" look */
.card{
  width:100% !important;
  background:transparent !important;
  border:none !important;
  border-radius:0 !important;
  box-shadow:none !important;
}
/* Top area is just black canvas */
.heroHeader, .heroInner{
  background:transparent !important;
  border:none !important;
  box-shadow:none !important;
  padding:0 !important;
}
/* Logo big */
.heroLogo{
  width:100% !important;
  max-width:1100px !important;
  max-height:620px !important;
  object-fit:cover !important;
  display:block !important;
  margin:0 auto !important;
  filter:none !important;
}
/* Only keep a simple outline on the email input (not the whole panel) */
.heroPanel{
  max-width:760px !important;
  margin:24px auto 0 auto !important;
  padding:18px 16px !important;
  background:transparent !important;
  border:none !important;
  box-shadow:none !important;
}
.input{
  background:rgba(0,0,0,.35) !important;
  border:none !important;
  box-shadow:none !important;
}
.input:focus{outline:none !important;}
/* Minimal button (no glow) */
.btn.green{
  background:#ffb000 !important;
  border-color:#ffb000 !important;
  color:#000 !important;
  box-shadow:none !important;
}
.btn.green::after{display:none !important;}
/* Text colors */
.h2{color:#2ee66b !important;}
.sub{color:rgba(255,255,255,.65) !important;}
/* Footer */
.footer{
  background:transparent !important;
  border:none !important;
}

/* ===== v552 LANDING LOCK ===== */
:root{
  --ng-blue:#00d7ff;
  --ng-blue2:#2a7fff;
  --ng-gold:#ffb000;
  --ng-orange:#ff7823;
  --ng-purple:#966eff;
}

/* Base canvas */
html,body{background:#000 !important;}
body::before, body::after{display:none !important;}

/* Kill any outer frames */
.card{
  background:transparent !important;
  border:none !important;
  box-shadow:none !important;
  border-radius:0 !important;
}
.heroHeader{
  border:none !important;
  background:transparent !important;
}
.heroInner{padding:10px 14px 0 14px !important;}
.heroLogo{
  width:min(980px,100%) !important;
  max-height:320px !important;
  object-fit:contain !important;
  filter:drop-shadow(0 26px 50px rgba(0,0,0,.70)) drop-shadow(0 0 22px rgba(0,215,255,.18)) drop-shadow(0 0 16px rgba(255,176,0,.10)) !important;
}

/* Radiant title stack */
.heroText{margin-top:6px; display:inline-block; line-height:1;}
.heroNight{
  font-weight:1000;
  letter-spacing:10px;
  font-size:20px;
  color:var(--ng-blue);
  text-shadow:
    0 0 14px rgba(0,215,255,.28),
    0 0 26px rgba(42,127,255,.18);
}
.heroGames{
  margin-top:6px;
  font-weight:1100;
  letter-spacing:6px;
  font-size:34px;
  background:linear-gradient(180deg, #ffe29a 0%, var(--ng-gold) 40%, #ff8f2e 100%);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  text-shadow:
    0 0 18px rgba(255,176,0,.18),
    0 0 26px rgba(255,120,35,.10);
}

/* Open panel (no border box) */
.heroPanel.open{
  background:transparent !important;
  border:none !important;
  box-shadow:none !important;
  padding:18px 14px 14px 14px !important;
  max-width:720px !important;
}
.h2{color:#2ee66b !important; font-weight:900 !important; letter-spacing:2px; text-transform:uppercase;}

/* Input with outward “explosive” glow */
.sparkField{
  position:relative;
  border-radius:16px;
}
.sparkField::before{
  content:"";
  position:absolute;
  inset:-10px;
  border-radius:20px;
  background:
    radial-gradient(120% 140% at 18% 30%, rgba(0,215,255,.16), rgba(0,0,0,0) 55%),
    radial-gradient(120% 140% at 80% 18%, rgba(255,176,0,.14), rgba(0,0,0,0) 58%),
    radial-gradient(140% 160% at 55% 110%, rgba(150,110,255,.10), rgba(0,0,0,0) 62%);
  filter:blur(6px);
  opacity:.95;
  pointer-events:none;
}
.sparkField::after{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius:18px;
  background:linear-gradient(90deg, rgba(0,215,255,.55), rgba(255,176,0,.40));
  opacity:.35;
  filter:blur(0px);
  pointer-events:none;
}
.inputEmail{
  position:relative;
  width:100%;
  border-radius:14px !important;
  border:1px solid rgba(0,215,255,.55) !important;
  background:rgba(0,0,0,.55) !important;
  box-shadow:0 0 0 1px rgba(255,255,255,.06) inset !important;
}

/* Glass beveled Enter button */
.btnEnter{
  width:100%;
  border-radius:999px !important;
  border:1px solid rgba(255,226,154,.55) !important;
  background:linear-gradient(180deg, #ffe29a 0%, var(--ng-gold) 45%, #ff8f2e 100%) !important;
  color:#120a00 !important;
  font-weight:1000 !important;
  letter-spacing:2px !important;
  text-transform:uppercase;
  position:relative;
  box-shadow:
    0 16px 34px rgba(0,0,0,.55),
    0 0 22px rgba(255,176,0,.14),
    0 0 18px rgba(0,215,255,.08) !important;
}
.btnEnter::before{
  content:"";
  position:absolute;
  inset:2px 6px auto 6px;
  height:42%;
  border-radius:999px;
  background:linear-gradient(180deg, rgba(255,255,255,.55), rgba(255,255,255,0));
  opacity:.55;
  pointer-events:none;
}
.btnEnter::after{display:none !important;}

/* Skinnier spark bar under Enter */
.sparkBar{
  margin-top:12px;
  height:10px;
  border-radius:999px;
  background:linear-gradient(90deg, rgba(0,215,255,.15), rgba(255,176,0,.22), rgba(255,120,35,.18));
  box-shadow:
    0 0 0 1px rgba(255,255,255,.06) inset,
    0 0 18px rgba(255,176,0,.10),
    0 0 14px rgba(0,215,255,.08);
  position:relative;
  overflow:hidden;
}
.sparkBar::before{
  content:"";
  position:absolute;
  inset:0;
  background:
    radial-gradient(circle at 18% 50%, rgba(255,255,255,.55), rgba(255,255,255,0) 20%),
    radial-gradient(circle at 62% 50%, rgba(255,255,255,.45), rgba(255,255,255,0) 18%),
    radial-gradient(circle at 86% 50%, rgba(255,255,255,.35), rgba(255,255,255,0) 16%);
  opacity:.55;
}

/* ===== v552: Enter button glass + granular text (ONLY) ===== */
#btnEnter{
  position:relative;
  border-radius:999px !important;
  border:1px solid rgba(255,230,170,.55) !important;

  /* glass bevel */
  background:
    linear-gradient(180deg, rgba(255,255,255,.55) 0%, rgba(255,255,255,0) 40%),
    linear-gradient(180deg, #ffe29a 0%, #ffb000 55%, #ff8f2e 100%) !important;

  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.55),
    inset 0 -10px 18px rgba(0,0,0,.45),
    0 18px 36px rgba(0,0,0,.55),
    0 0 20px rgba(255,176,0,.16),
    0 0 14px rgba(0,215,255,.08) !important;

  font-weight:1000 !important;
  letter-spacing:2px !important;
  text-transform:uppercase !important;
  color:#120a00 !important;
}

/* top shine streak */
#btnEnter::before{
  content:"";
  position:absolute;
  left:10px; right:10px; top:6px;
  height:40%;
  border-radius:999px;
  background:linear-gradient(180deg, rgba(255,255,255,.70), rgba(255,255,255,0));
  opacity:.55;
  pointer-events:none;
}

/* granular sparkle overlay */
#btnEnter::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:999px;
  background:
    radial-gradient(circle at 18% 45%, rgba(255,255,255,.45), rgba(255,255,255,0) 22%),
    radial-gradient(circle at 62% 35%, rgba(255,255,255,.35), rgba(255,255,255,0) 18%),
    radial-gradient(circle at 86% 55%, rgba(255,255,255,.25), rgba(255,255,255,0) 16%),
    radial-gradient(rgba(255,255,255,.18) 1px, transparent 1px);
  background-size:auto,auto,auto,4px 4px;
  opacity:.35;
  mix-blend-mode:screen;
  pointer-events:none;
}

/* make the label feel "granular" like GAMES */
#btnEnter span, #btnEnter{
  text-shadow:
    0 0 10px rgba(255,176,0,.14),
    0 0 14px rgba(255,120,35,.10);
}

/* ===== v552 tweaks: glossy enter + spacing + blue title glass ===== */

/* Glossy glass ENTER (ensure applies even if classes differ) */
#btnEnter, .btn.green{
  background:
    linear-gradient(180deg, rgba(255,255,255,.72), rgba(255,255,255,0) 42%),
    linear-gradient(180deg, #ffe9b8 0%, #ffd000 32%, #ffb000 58%, #ff8f2e 100%) !important;
  border:1px solid rgba(255,226,154,.62) !important;
  box-shadow:
    inset 0 1px 0 rgba(255,255,255,.65),
    inset 0 -10px 18px rgba(0,0,0,.35),
    0 18px 40px rgba(0,0,0,.55),
    0 0 26px rgba(255,176,0,.16) !important;
  position:relative;
  overflow:hidden;
}

/* extra glossy streak */
#btnEnter::before, .btn.green::before{
  content:"";
  position:absolute;
  left:-20%;
  top:-35%;
  width:140%;
  height:85%;
  background:linear-gradient(135deg, rgba(255,255,255,.55), rgba(255,255,255,0) 55%);
  transform:rotate(-6deg);
  opacity:.55;
  pointer-events:none;
}

/* granular sparkle texture */
#btnEnter::after, .btn.green::after{
  content:"";
  position:absolute;
  inset:0;
  background-image:
    radial-gradient(rgba(255,255,255,.40) 1px, transparent 1px),
    radial-gradient(rgba(255,255,255,.22) 1px, transparent 1px);
  background-size:6px 6px, 10px 10px;
  background-position:0 0, 3px 5px;
  opacity:.18;
  pointer-events:none;
}

/* 2) Spacing: make area between ENTER and spark bar breathe */
#btnEnter, .btn.green{ margin-bottom:10px !important; }
.sparkBar{ margin-top:22px !important; height:8px !important; }


/* ===== v552 TITLE MATCHES LOGO NIGHT BLUE ===== */

.heroNight, .heroGames{
  font-weight:1100;
  letter-spacing:8px;
  background:linear-gradient(180deg, #8ff6ff 0%, #00d7ff 35%, #2a7fff 75%, #0040ff 100%);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent !important;
  text-shadow:
    0 0 12px rgba(0,215,255,.55),
    0 0 28px rgba(0,215,255,.35),
    0 0 45px rgba(42,127,255,.25);
  position:relative;
}

/* subtle crystalline grain like logo */
.heroNight::after, .heroGames::after{
  content:"";
  position:absolute;
  inset:-2px;
  background-image:
    radial-gradient(rgba(255,255,255,.45) 1px, transparent 1px);
  background-size:6px 6px;
  opacity:.10;
  pointer-events:none;
}

/* ===== v552: Deep blue email border + darker subtitle ===== */

/* Email entry field (above Enter) */
#inEmail{
  border:2px solid #0040ff !important; /* dart-flight deep blue */
  border-radius:14px !important;
  background:rgba(0,0,0,.65) !important;
  box-shadow:
    0 0 10px rgba(0,64,255,.28),
    0 0 18px rgba(0,64,255,.18),
    inset 0 0 8px rgba(0,64,255,.12) !important;
}
#inEmail:focus{
  outline:none !important;
  box-shadow:
    0 0 14px rgba(0,64,255,.42),
    0 0 26px rgba(0,64,255,.22),
    inset 0 0 10px rgba(0,64,255,.18) !important;
}

/* Text under Night Games (heroSub) darker blue */
.heroSub{
  background:none !important;
  -webkit-background-clip:initial !important;
  background-clip:initial !important;
  color:#0040ff !important;
  text-shadow:
    0 0 10px rgba(0,64,255,.22),
    0 0 18px rgba(0,64,255,.14) !important;
  opacity:1 !important;
}

/* ===== v552: TRUE FLOATING (no panels/frames/backgrounds on elements) ===== */

/* Space/void background like logo backdrop */
html, body{
  background:
    radial-gradient(120% 90% at 18% 12%, rgba(0,210,255,.12), rgba(0,0,0,0) 55%),
    radial-gradient(110% 80% at 82% 14%, rgba(255,175,0,.10), rgba(0,0,0,0) 58%),
    radial-gradient(120% 120% at 50% 96%, rgba(160,120,255,.08), rgba(0,0,0,0) 62%),
    #000 !important;
}

/* Subtle spark flecks */
body::after{
  content:"";
  position:fixed; inset:0;
  background-image:
    radial-gradient(rgba(255,255,255,.22) 1px, transparent 1px),
    radial-gradient(rgba(0,210,255,.18) 1px, transparent 1px),
    radial-gradient(rgba(255,175,0,.14) 1px, transparent 1px);
  background-size: 95px 95px, 140px 140px, 180px 180px;
  background-position: 0 0, 34px 58px, 72px 24px;
  opacity:.07;
  pointer-events:none;
}

/* Kill ALL frames/panels/boxes */
.card, .heroPanel, .heroHeader, .panel, .panelInner, .shell, .frame, .wrapPanel{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  backdrop-filter: none !important;
}

/* Make every "section" feel like a PNG floating */
.heroPanel, .heroHeader, .footer{
  padding-left: 0 !important;
  padding-right: 0 !important;
}

/* Title: match the NIGHT blue feel */
.h1{
  background: linear-gradient(180deg, #bff7ff 0%, #38c7ff 42%, #1c5cff 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent !important;
  text-shadow:
    0 0 16px rgba(0,210,255,.26),
    0 0 34px rgba(42,127,255,.18);
}

/* Subtitle darker blue */
.heroSub{
  color: rgba(56,151,255,.72) !important;
}

/* SIGN IN label pops but still floating */
.h2{
  color: #28ff7f !important;
  text-shadow: 0 0 16px rgba(46,230,107,.18);
}

/* Input: NO background, only glow outline */
#inEmail, input[type="email"]{
  background: transparent !important;
  border: 2px solid #0a4bff !important;
  box-shadow:
    0 0 14px rgba(10,75,255,.55),
    0 0 30px rgba(10,75,255,.22),
    inset 0 0 10px rgba(10,75,255,.18) !important;
  border-radius: 16px !important;
}
#inEmail::placeholder{
  color: rgba(200,220,255,.40) !important;
}

/* ENTER button: glossy glass gold (this is the "PNG" look) */
#btnEnter{
  background:
    linear-gradient(180deg, rgba(255,255,255,.55), rgba(255,255,255,0) 38%),
    linear-gradient(180deg, #ffeaa0 0%, #ffcc3a 35%, #c58200 100%) !important;
  border: 1px solid rgba(255,255,255,.22) !important;
  box-shadow:
    0 16px 40px rgba(0,0,0,.55),
    0 0 26px rgba(255,180,0,.20),
    inset 0 1px 0 rgba(255,255,255,.55),
    inset 0 -10px 18px rgba(0,0,0,.18) !important;
}
#btnEnter span, #btnEnter{
  letter-spacing: 3px;
}

/* Remove any extra button/box under Enter if present */
#btnClear, .btnClear, .clearRow{
  display:none !important;
}

/* Under-enter bar: thin, glowing, spark-like */
.sparkBar, .underBar{
  height: 10px !important;
  border-radius: 999px !important;
  background:
    linear-gradient(90deg, rgba(0,70,255,.10), rgba(0,210,255,.18), rgba(255,175,0,.14), rgba(0,70,255,.10)) !important;
  box-shadow:
    0 0 18px rgba(0,210,255,.10),
    0 0 18px rgba(255,175,0,.08) !important;
  position: relative;
  overflow: hidden;
}
.sparkBar::after, .underBar::after{
  content:"";
  position:absolute; inset:-40% -60%;
  background:
    radial-gradient(circle at 20% 30%, rgba(255,255,255,.20), rgba(255,255,255,0) 35%),
    radial-gradient(circle at 65% 60%, rgba(0,210,255,.18), rgba(0,210,255,0) 38%),
    radial-gradient(circle at 85% 40%, rgba(255,175,0,.16), rgba(255,175,0,0) 42%);
  animation: sparkDrift 3.4s linear infinite;
  opacity:.55;
}
@keyframes sparkDrift{
  0%{ transform: translateX(-18%) translateY(0); }
  100%{ transform: translateX(18%) translateY(0); }
}

/* Spacing so it breathes */
.heroHeader{ margin-top: 8px !important; }
.heroPanel{ margin-top: 10px !important; }
.field{ margin-top: 14px !important; }
#btnEnter{ margin-top: 18px !important; margin-bottom: 14px !important; }
.sparkBar{ margin-top: 18px !important; margin-bottom: 22px !important; }

/* Version badge: impossible to miss */
.badge{
  position: fixed !important;
  top: 10px !important;
  right: 12px !important;
  z-index: 9999 !important;
  padding: 6px 10px !important;
  border-radius: 12px !important;
  background: rgba(0,0,0,.28) !important;
  border: 1px solid rgba(0,210,255,.22) !important;
  color: #8ff6ff !important;
  font-weight: 900 !important;
  letter-spacing: 2px !important;
  box-shadow: 0 0 16px rgba(0,210,255,.16) !important;
}

/* ===== v552: ZERO BACKGROUNDS + OUTLINE-ONLY ENTER ===== */

/* No backgrounds anywhere (everything floats) */
*{
  background-color: transparent !important;
}

/* Keep body void background (override the * rule for html/body) */
html, body{
  background:
    radial-gradient(120% 90% at 18% 12%, rgba(0,210,255,.12), rgba(0,0,0,0) 55%),
    radial-gradient(110% 80% at 82% 14%, rgba(255,175,0,.10), rgba(0,0,0,0) 58%),
    radial-gradient(120% 120% at 50% 96%, rgba(160,120,255,.08), rgba(0,0,0,0) 62%),
    #000 !important;
}

/* Email input: outline-only, deep blue, readable text */
#inEmail, input[type="email"]{
  background: transparent !important;
  border: 2px solid #0a4bff !important;
  color: rgba(235,245,255,.92) !important;
  box-shadow:
    0 0 14px rgba(10,75,255,.55),
    0 0 30px rgba(10,75,255,.22),
    inset 0 0 10px rgba(10,75,255,.12) !important;
  border-radius: 16px !important;
}
#inEmail::placeholder, input[type="email"]::placeholder{
  color: rgba(200,220,255,.45) !important;
}

/* ENTER button: outline-only yellow neon, text floating */
#btnEnter, .btn.green{
  background: transparent !important;
  border: 2px solid #ffd000 !important;
  color: #ffd000 !important;
  text-shadow:
    0 0 12px rgba(255,208,0,.45),
    0 0 24px rgba(255,160,0,.25) !important;
  box-shadow:
    0 0 18px rgba(255,208,0,.22),
    0 0 34px rgba(255,160,0,.14),
    inset 0 0 0 rgba(0,0,0,0) !important;
}
#btnEnter::before, #btnEnter::after,
.btn.green::before, .btn.green::after{
  content:none !important; /* remove glass layers */
}

/* Hover/press feedback */
#btnEnter:active, .btn.green:active{
  transform: translateY(1px);
  box-shadow:
    0 0 14px rgba(255,208,0,.18),
    0 0 26px rgba(255,160,0,.12) !important;
}

/* Under-enter bar stays as a glowing line (no fill backgrounds elsewhere) */
.sparkBar, .underBar{
  background:
    linear-gradient(90deg, rgba(0,70,255,.10), rgba(0,210,255,.18), rgba(255,175,0,.14), rgba(0,70,255,.10)) !important;
}

/* Make sure any leftover cards/panels have no borders either */
.card, .heroPanel, .heroHeader, .panel, .shell, .frame{
  border:none !important;
  box-shadow:none !important;

  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
}

/* Ensure labels remain visible */
label, .label, .small, .hint{
  color: rgba(210,230,255,.70) !important;
}

/* Version badge stays readable */
.badge{
  background: rgba(0,0,0,.28) !important; /* allowed exception */
  border: 1px solid rgba(0,210,255,.22) !important;
}

/* ===== v552: FRAME FULLY REMOVED ===== */

/* Kill any remaining structural containers */
.frame, .shell, .outer, .container, .wrapper, .appFrame {
    display: contents !important;
}

/* Remove any remaining borders globally */
* {
    border: none !important;
}

/* Re-apply ONLY the necessary outlines */

/* Email outline (deep blue neon) */
#inEmail, input[type="email"]{
    border: 2px solid #0a4bff !important;
    box-shadow:
        0 0 14px rgba(10,75,255,.55),
        0 0 30px rgba(10,75,255,.22),
        inset 0 0 10px rgba(10,75,255,.12) !important;
}

/* Enter outline (yellow neon only) */
#btnEnter{
    border: 2px solid #ffd000 !important;
    box-shadow:
        0 0 18px rgba(255,208,0,.22),
        0 0 34px rgba(255,160,0,.14) !important;
}

/* Ensure nothing wraps the whole screen visually */
body > div {
    background: transparent !important;
    box-shadow: none !important;
}

/* ===== v552: BRUTE FORCE NO-FRAME / NO-BACKGROUNDS ===== */

/* 1) Nuke all frames/panels/wrappers */
.frame,.shell,.outer,.container,.wrapper,.appFrame,.card,.wrap,.panel,.heroPanel,.heroHeader,.viewport,.phone,.stage,.canvas{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
  backdrop-filter: none !important;
}

/* 2) Nuke ALL element backgrounds (including shorthand 'background') */
*:not(html):not(body){
  background: transparent !important;
  border-color: transparent !important;
  box-shadow: none !important;
}

/* 3) Keep body void background */
html,body{
  background:
    radial-gradient(120% 90% at 18% 12%, rgba(0,210,255,.12), rgba(0,0,0,0) 55%),
    radial-gradient(110% 80% at 82% 14%, rgba(255,175,0,.10), rgba(0,0,0,0) 58%),
    radial-gradient(120% 120% at 50% 96%, rgba(160,120,255,.08), rgba(0,0,0,0) 62%),
    #000 !important;
}

/* 4) Re-apply ONLY the intended outlines / glows */

/* Email input outline */
#inEmail, input[type="email"]{
  background: transparent !important;
  border: 2px solid #0a4bff !important;
  border-radius: 16px !important;
  box-shadow:
    0 0 14px rgba(10,75,255,.55),
    0 0 30px rgba(10,75,255,.22),
    inset 0 0 10px rgba(10,75,255,.12) !important;
  color: rgba(235,245,255,.92) !important;
}

/* Enter outline */
#btnEnter, .btn.green{
  background: transparent !important;
  border: 2px solid #ffd000 !important;
  border-radius: 16px !important;
  color: #ffd000 !important;
  text-shadow:
    0 0 12px rgba(255,208,0,.45),
    0 0 24px rgba(255,160,0,.25) !important;
  box-shadow:
    0 0 18px rgba(255,208,0,.22),
    0 0 34px rgba(255,160,0,.14) !important;
}

/* Under-enter bar (thin glowing line) */
.sparkBar, .underBar{
  background:
    linear-gradient(90deg, rgba(0,70,255,.10), rgba(0,210,255,.18), rgba(255,175,0,.14), rgba(0,70,255,.10)) !important;
  box-shadow:
    0 0 18px rgba(0,210,255,.10),
    0 0 18px rgba(255,175,0,.08) !important;
}

/* Version badge (small, top-right) */
.badge{
  background: rgba(0,0,0,.28) !important;
  border: 1px solid rgba(0,210,255,.22) !important;
  box-shadow: 0 0 16px rgba(0,210,255,.16) !important;
}

/* ===== v552: logo-canvas background + truly floating UI (no frames) ===== */

/* Background matches the logo-backdrop vibe (cool blue + warm amber on black) */
html, body{
  background:
    radial-gradient(120% 90% at 18% 12%, rgba(0,210,255,.14), rgba(0,0,0,0) 55%),
    radial-gradient(110% 80% at 82% 14%, rgba(255,175,0,.12), rgba(0,0,0,0) 58%),
    radial-gradient(120% 120% at 50% 96%, rgba(160,120,255,.09), rgba(0,0,0,0) 62%),
    #000 !important;
}

/* Subtle star/spark flecks */
body::after{
  content:"";
  position:fixed; inset:0;
  background-image:
    radial-gradient(rgba(255,255,255,.22) 1px, transparent 1px),
    radial-gradient(rgba(0,210,255,.18) 1px, transparent 1px),
    radial-gradient(rgba(255,175,0,.14) 1px, transparent 1px);
  background-size: 95px 95px, 140px 140px, 180px 180px;
  background-position: 0 0, 34px 58px, 72px 24px;
  opacity:.07;
  pointer-events:none;
}

/* Hard remove ANY frame/panel/container visuals */
.frame,.shell,.outer,.container,.wrapper,.appFrame,.card,.wrap,.panel,.heroPanel,.heroHeader,.viewport,.phone,.stage,.canvas{
  background: transparent !important;
  border: none !important;
  box-shadow: none !important;
  outline: none !important;
  backdrop-filter: none !important;
}

/* Remove ALL element backgrounds so everything floats */
*:not(html):not(body):not(#bgSweepVideo){
  background: transparent !important;
}

/* Remove ALL borders by default, then re-add only what we want */
*:not(html):not(body){
  border-color: transparent !important;
}

/* Title: blue radiant (like "Night" in logo) */
.h1{
  background: linear-gradient(180deg, #bff7ff 0%, #38c7ff 42%, #1c5cff 100%);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent !important;
  text-shadow:
    0 0 16px rgba(0,210,255,.26),
    0 0 34px rgba(42,127,255,.18);
}

/* Email input: outline-only deep blue */
#inEmail, input[type="email"]{
  border: 2px solid #0a4bff !important;
  border-radius: 16px !important;
  box-shadow:
    0 0 14px rgba(10,75,255,.55),
    0 0 30px rgba(10,75,255,.22),
    inset 0 0 10px rgba(10,75,255,.12) !important;
  color: rgba(235,245,255,.92) !important;
}
#inEmail::placeholder, input[type="email"]::placeholder{
  color: rgba(200,220,255,.45) !important;
}

/* ENTER button: outline-only yellow neon (no fill) */
#btnEnter, .btn.green{
  background: transparent !important;
  border: 2px solid #ffd000 !important;
  border-radius: 16px !important;
  color: #ffd000 !important;
  text-shadow:
    0 0 12px rgba(255,208,0,.45),
    0 0 24px rgba(255,160,0,.25) !important;
  box-shadow:
    0 0 18px rgba(255,208,0,.22),
    0 0 34px rgba(255,160,0,.14) !important;
}
#btnEnter::before, #btnEnter::after,
.btn.green::before, .btn.green::after{
  content:none !important;
}

/* Under-enter strip: thin glowing line */
.sparkBar, .underBar{
  background:
    linear-gradient(90deg, rgba(0,70,255,.10), rgba(0,210,255,.18), rgba(255,175,0,.14), rgba(0,70,255,.10)) !important;
  box-shadow:
    0 0 18px rgba(0,210,255,.10),
    0 0 18px rgba(255,175,0,.08) !important;
  border:none !important;
  border-radius: 999px !important;
}

/* Hide clear button if present */
#btnClear, .btnClear, .clearRow{ display:none !important; }

/* Version: top-right badge + subtle center watermark (theme-matching) */
.badge{
  position:fixed !important;
  top:10px !important;
  right:12px !important;
  z-index:9999 !important;
  padding:6px 10px !important;
  border-radius:12px !important;
  background: rgba(0,0,0,.28) !important;
  border: 1px solid rgba(0,210,255,.22) !important;
  color:#8ff6ff !important;
  font-weight:900 !important;
  letter-spacing:2px !important;
  box-shadow:0 0 16px rgba(0,210,255,.16) !important;
}
.wmVer{
  position:fixed; inset:0;
  display:flex; align-items:center; justify-content:center;
  font-size:min(14vw,110px);
  font-weight:1000;
  letter-spacing:6px;
  color:rgba(143,246,255,.22);
  text-shadow:0 0 26px rgba(0,210,255,.14);
  pointer-events:none;
  z-index:5;
}

/* ===== v552: POLISH PASS (space atmosphere + true floating + small version) ===== */

/* Deeper space: reduce "wall gradient" look, add vignette */
html, body{
  background:
    radial-gradient(110% 80% at 20% 14%, rgba(0,210,255,.12), rgba(0,0,0,0) 58%),
    radial-gradient(100% 75% at 82% 16%, rgba(255,175,0,.10), rgba(0,0,0,0) 60%),
    radial-gradient(120% 120% at 50% 96%, rgba(90,140,255,.08), rgba(0,0,0,0) 66%),
    radial-gradient(120% 120% at 50% 50%, rgba(0,0,0,0), rgba(0,0,0,.70) 72%),
    #000 !important;
}
body::before{
  content:"";
  position:fixed; inset:-10%;
  background:
    radial-gradient(circle at 50% 38%, rgba(0,0,0,0) 0%, rgba(0,0,0,.55) 62%, rgba(0,0,0,.82) 100%);
  pointer-events:none;
  z-index:0;
}

/* Star dust: smaller + less repetitive */
body::after{
  opacity:.055 !important;
  background-size: 110px 110px, 170px 170px, 230px 230px !important;
  filter: blur(.1px);
  z-index:0;
}

/* Make sure content is above background layers */
body > *{
  position:relative;
  z-index:2;
}

/* TRUE floating: no element backgrounds anywhere (keep only outlines on input/button) */
*:not(html):not(body){
  background: transparent !important;
}

/* Title + labels: add depth like neon */
.h1{
  text-shadow:
    0 0 10px rgba(0,210,255,.18),
    0 0 22px rgba(42,127,255,.18),
    0 10px 30px rgba(0,0,0,.55) !important;
}

/* Sign-in label: slight lift */
.h2{
  text-shadow:
    0 0 14px rgba(46,230,107,.18),
    0 10px 26px rgba(0,0,0,.60) !important;
  letter-spacing: 2px !important;
}

/* Email field: add subtle glass highlight line (still no fill) */
#inEmail{
  position:relative;
}
#inEmail{
  box-shadow:
    0 0 14px rgba(10,75,255,.55),
    0 0 34px rgba(10,75,255,.18),
    inset 0 0 10px rgba(10,75,255,.10) !important;
}
#inEmail{
  background: transparent !important;
}
#inEmail{
  background-image: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,0) 35%) !important;
  background-repeat:no-repeat !important;
  background-size: 100% 100% !important;
}

/* ENTER outline: add a top-edge sheen (still outline-only) */
#btnEnter{
  position:relative;
  overflow:hidden;
}
#btnEnter::after{
  content:"";
  position:absolute;
  left:-30%;
  top:8%;
  width:160%;
  height:45%;
  background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.18), rgba(255,255,255,0));
  transform: rotate(-8deg);
  opacity:.65;
  pointer-events:none;
}
#btnEnter{
  box-shadow:
    0 0 18px rgba(255,208,0,.22),
    0 0 38px rgba(255,160,0,.12),
    0 14px 34px rgba(0,0,0,.62) !important;
}

/* Under-enter strip: make it a light streak (thinner + spark) */
.sparkBar, .underBar{
  height: 8px !important;
  box-shadow:
    0 0 18px rgba(0,210,255,.10),
    0 0 16px rgba(255,175,0,.07),
    0 12px 30px rgba(0,0,0,.65) !important;
}
.sparkBar::after, .underBar::after{
  opacity:.42 !important;
}

/* Spacing: breathing room */
.field{ margin-top: 18px !important; margin-bottom: 10px !important; }
#btnEnter{ margin-top: 20px !important; margin-bottom: 16px !important; }
.sparkBar{ margin-top: 20px !important; margin-bottom: 26px !important; }

/* Version: small, bottom-left, never center */
.badge{
  top:auto !important;
  right:auto !important;
  bottom:10px !important;
  left:12px !important;
  font-size:12px !important;
  letter-spacing:1px !important;
  padding:5px 8px !important;
  opacity:.55 !important;
  box-shadow:none !important;
  background: transparent !important;
  border: 1px solid rgba(0,210,255,.14) !important;
}

/* ===== v552: WOW POLISH (space-float + unified neon light) ===== */

/* 1) Deep void canvas (logo-like atmosphere) */
html, body{
  background:
    radial-gradient(120% 85% at 18% 10%, rgba(0,210,255,.16), rgba(0,0,0,0) 58%),
    radial-gradient(105% 75% at 84% 12%, rgba(255,175,0,.13), rgba(0,0,0,0) 60%),
    radial-gradient(120% 120% at 52% 96%, rgba(120,160,255,.10), rgba(0,0,0,0) 68%),
    radial-gradient(140% 120% at 50% 55%, rgba(0,0,0,0) 0%, rgba(0,0,0,.68) 70%, rgba(0,0,0,.86) 100%),
    #000 !important;
}
/* soft vignette */
body::before{
  content:"";
  position:fixed; inset:-18%;
  background: radial-gradient(circle at 50% 32%, rgba(0,0,0,0) 0%, rgba(0,0,0,.55) 58%, rgba(0,0,0,.88) 100%);
  pointer-events:none;
  z-index:0;
}
/* cosmic dust (tiny + subtle) */
body::after{
  content:"";
  position:fixed; inset:0;
  background-image:
    radial-gradient(rgba(255,255,255,.20) 1px, transparent 1px),
    radial-gradient(rgba(0,210,255,.16) 1px, transparent 1px),
    radial-gradient(rgba(255,175,0,.12) 1px, transparent 1px);
  background-size: 140px 140px, 220px 220px, 280px 280px;
  background-position: 0 0, 48px 76px, 112px 36px;
  opacity:.05;
  pointer-events:none;
  z-index:0;
  filter: blur(.2px);
}

/* Ensure UI sits above atmosphere */
body > *{ position:relative; z-index:2; }

/* 2) TRUE floating: no fills anywhere (except tiny version badge background) */
*:not(html):not(body){
  background: transparent !important;
}

/* 3) Remove any frame/panel remnants */
.frame,.shell,.outer,.container,.wrapper,.appFrame,.card,.wrap,.panel,.heroPanel,.heroHeader,.viewport,.phone,.stage,.canvas{
  background: transparent !important;
  border:none !important;
  box-shadow:none !important;
  outline:none !important;
}

/* 4) Unified depth: everything gets a soft suspension shadow */
.logoWrap, .logo, .h1, .h2, #inEmail, #btnEnter, .sparkBar, .underBar{
  filter: drop-shadow(0 14px 28px rgba(0,0,0,.66));
}

/* 5) Logo: extend neon bleed downward subtly (light diffusion) */
.logoWrap::after, .logo::after{
  content:"";
  position:absolute;
  left:50%;
  top:100%;
  width:min(520px,92vw);
  height:140px;
  transform: translateX(-50%);
  background:
    radial-gradient(closest-side, rgba(0,210,255,.18), rgba(0,0,0,0) 70%),
    radial-gradient(closest-side, rgba(255,175,0,.10), rgba(0,0,0,0) 72%);
  opacity:.45;
  pointer-events:none;
  filter: blur(6px);
}
.logoWrap{ position:relative; }

/* 6) Title: neon blue like logo NIGHT, with sparkle bloom */
.h1{
  background: linear-gradient(180deg, #c7fbff 0%, #43d0ff 42%, #1b55ff 100%) !important;
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent !important;
  text-shadow:
    0 0 12px rgba(0,210,255,.18),
    0 0 26px rgba(42,127,255,.18),
    0 18px 34px rgba(0,0,0,.65);
}

/* 7) Email field: magnetic neon aura (no fill, just light in the air) */
.field, .emailRow, .emailWrap{ position:relative; }
.field::before, .emailRow::before, .emailWrap::before{
  content:"";
  position:absolute;
  left:50%;
  top:50%;
  width:min(560px,92vw);
  height:110px;
  transform: translate(-50%,-50%);
  background:
    radial-gradient(closest-side, rgba(10,75,255,.24), rgba(0,0,0,0) 72%),
    radial-gradient(closest-side, rgba(0,210,255,.10), rgba(0,0,0,0) 78%);
  opacity:.55;
  filter: blur(10px);
  pointer-events:none;
  z-index:0;
}
#inEmail{
  position:relative;
  z-index:2;
  border: 2px solid #0a4bff !important;
  border-radius: 16px !important;
  color: rgba(235,245,255,.92) !important;
  box-shadow:
    0 0 16px rgba(10,75,255,.58),
    0 0 36px rgba(10,75,255,.20),
    inset 0 0 12px rgba(10,75,255,.10) !important;
  background-image: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,0) 38%) !important;
}
#inEmail::placeholder{ color: rgba(200,220,255,.48) !important; }

/* 8) ENTER: glass + neon edge (still no solid fill) */
#btnEnter, .btn.green{
  position:relative;
  z-index:2;
  border: 2px solid #ffd000 !important;
  border-radius: 16px !important;
  color: #ffd000 !important;
  text-shadow:
    0 0 12px rgba(255,208,0,.45),
    0 0 26px rgba(255,160,0,.22);
  box-shadow:
    0 0 18px rgba(255,208,0,.24),
    0 0 44px rgba(255,160,0,.10) !important;
  overflow:hidden;
}
/* Glass sheen */
#btnEnter::after{
  content:"";
  position:absolute;
  left:-35%;
  top:6%;
  width:170%;
  height:48%;
  background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.20), rgba(255,255,255,0));
  transform: rotate(-8deg);
  opacity:.70;
  pointer-events:none;
}
/* Subtle underglow = floating */
#btnEnter::before{
  content:"";
  position:absolute;
  left:50%;
  top:100%;
  width:120%;
  height:28px;
  transform: translate(-50%,-30%);
  background: radial-gradient(closest-side, rgba(255,208,0,.26), rgba(0,0,0,0) 72%);
  filter: blur(10px);
  opacity:.75;
  pointer-events:none;
}
#btnEnter:active{ transform: translateY(1px); }

/* 9) Under-enter bar becomes a runway light strip */
.sparkBar, .underBar{
  height: 8px !important;
  border-radius: 999px !important;
  background: linear-gradient(90deg,
    rgba(10,75,255,.10),
    rgba(0,210,255,.22),
    rgba(255,175,0,.16),
    rgba(10,75,255,.10)
  ) !important;
  box-shadow:
    0 0 16px rgba(0,210,255,.12),
    0 0 14px rgba(255,175,0,.08);
  position:relative;
  overflow:hidden;
}
.sparkBar::after, .underBar::after{
  content:"";
  position:absolute;
  inset:-60% -40%;
  background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.22), rgba(255,255,255,0));
  transform: translateX(-40%);
  animation: beamSweep 5.8s linear infinite;
  opacity:.35;
  pointer-events:none;
}
@keyframes beamSweep{
  0%{ transform: translateX(-60%) rotate(8deg); }
  100%{ transform: translateX(60%) rotate(8deg); }
}

/* 10) Breathing room */
.field{ margin-top: 18px !important; margin-bottom: 10px !important; }
#btnEnter{ margin-top: 22px !important; margin-bottom: 16px !important; }
.sparkBar{ margin-top: 20px !important; margin-bottom: 26px !important; }

/* 11) Version: small, bottom-right, subtle */
.badge{
  position:fixed !important;
  top:auto !important;
  left:auto !important;
  right:12px !important;
  bottom:10px !important;
  font-size:12px !important;
  letter-spacing:1px !important;
  padding:5px 8px !important;
  opacity:.55 !important;
  background: rgba(0,0,0,.22) !important;
  border: 1px solid rgba(0,210,255,.14) !important;
  color:#8ff6ff !important;
  border-radius: 12px !important;
  box-shadow:none !important;
}

/* safety: hide any leftover center watermark classes */
.wmVer, .wm540{ display:none !important; }

/* ===== v552: TRUE NO-FRAME / NO-PANELS (everything floats) ===== */
.wrap{padding:0 !important; align-items:flex-start !important; justify-content:center !important;}
#app.card, .card{
  width:100% !important;
  max-width:100% !important;
  background:transparent !important;
  border:0 !important;
  border-radius:0 !important;
  box-shadow:none !important;
  backdrop-filter:none !important;
  overflow:visible !important;
}
.heroHeader{
  background:transparent !important;
  border:0 !important;
  box-shadow:none !important;
}
.panel, .heroPanel{
  background:transparent !important;
  border:0 !important;
  box-shadow:none !important;
}
.footer{
  background:transparent !important;
  border-top:0 !important;
  box-shadow:none !important;
}
/* Ensure no accidental perimeter frame from any element */
.card::before, .card::after, .wrap::before, .wrap::after, #app::before, #app::after{
  content:none !important;
}
/* Keep only the intended interactive outlines */
#inEmail{border:2px solid #0a4bff !important;}
#btnEnter{border:2px solid #ffd000 !important;}

/* ===== v552: REMOVE FRAME FOR REAL + TRUE FLOATING DEPTH ===== */

/* 0) Hard reset: NO page inset / NO outer frame */
html,body{margin:0 !important;padding:0 !important;border:0 !important;outline:0 !important;background:#000 !important;overflow-x:hidden !important;}

/* 1) Kill any wrapper/card/panel visuals that read as a frame */
.wrap,.card,.panel,.container,.phone,.viewport,.shell,.frame,
.heroPanel, .panel.heroPanel{
  background:transparent !important;
  border:0 !important;
  outline:0 !important;
  box-shadow:none !important;
  border-radius:0 !important;
  padding:0 !important;
  margin:0 !important;
}
.wrap::before,.wrap::after,
.card::before,.card::after,
.panel::before,.panel::after,
.container::before,.container::after,
.phone::before,.phone::after,
.viewport::before,.viewport::after,
.shell::before,.shell::after,
.frame::before,.frame::after,
.heroPanel::before,.heroPanel::after{
  content:none !important;
  background:transparent !important;
  border:0 !important;
  box-shadow:none !important;
}

/* 2) Background like the logo canvas (void + subtle color bloom) */
body{
  background:
    radial-gradient(110% 75% at 18% 10%, rgba(0,210,255,.14), rgba(0,0,0,0) 58%),
    radial-gradient(100% 70% at 84% 12%, rgba(255,175,0,.10), rgba(0,0,0,0) 60%),
    radial-gradient(120% 100% at 50% 95%, rgba(120,160,255,.09), rgba(0,0,0,0) 70%),
    radial-gradient(140% 120% at 50% 55%, rgba(0,0,0,0) 0%, rgba(0,0,0,.70) 70%, rgba(0,0,0,.90) 100%),
    #000 !important;
}

/* 3) Make every visible element feel like it floats (depth + glow), without adding backgrounds */
.logo,.logoWrap,img,video,
h1,h2,h3,p,small,label,
input,button,.btn,
.sparkBar,.underBar{
  filter: drop-shadow(0 14px 28px rgba(0,0,0,.70)) !important;
}

/* 4) Remove “filled” button and filled blocks: outline + glow only */
button,.btn{
  background:transparent !important;
}
#btnEnter,.btnEnter{
  border:2px solid rgba(255,208,0,.95) !important;
  color: rgba(255,208,0,.98) !important;
  box-shadow: 0 0 16px rgba(255,208,0,.20), 0 0 34px rgba(255,175,0,.12) !important;
  border-radius:16px !important;
  position:relative;
  overflow:hidden;
}
#btnEnter::after,.btnEnter::after{
  content:"";
  position:absolute;
  left:-35%; top:8%;
  width:170%; height:46%;
  background: linear-gradient(90deg, rgba(255,255,255,0), rgba(255,255,255,.18), rgba(255,255,255,0));
  transform: rotate(-8deg);
  opacity:.70;
  pointer-events:none;
}

/* 5) Email input: outline + deep-blue glow (no background block) */
input, #inEmail{
  background:transparent !important;
}
#inEmail{
  border:2px solid rgba(10,75,255,.95) !important;
  border-radius:16px !important;
  color: rgba(235,245,255,.92) !important;
  box-shadow: 0 0 16px rgba(10,75,255,.38), 0 0 34px rgba(0,210,255,.10) !important;
}
#inEmail::placeholder{ color: rgba(200,220,255,.46) !important; }

/* 6) Under-enter strip = floating runway light (no frame) */
.sparkBar,.underBar{
  height:8px !important;
  border-radius:999px !important;
  background: linear-gradient(90deg, rgba(0,210,255,.10), rgba(145,70,255,.18), rgba(255,175,0,.10), rgba(0,210,255,.10)) !important;
  box-shadow: 0 0 16px rgba(0,210,255,.14), 0 0 18px rgba(145,70,255,.10) !important;
  border:0 !important;
}

/* 7) Version badge: small, bottom-right */
.badge{
  position:fixed !important;
  right:12px !important; bottom:10px !important;
  left:auto !important; top:auto !important;
  font-size:12px !important;
  padding:5px 8px !important;
  opacity:.55 !important;
  background: rgba(0,0,0,.22) !important;
  border: 1px solid rgba(0,210,255,.14) !important;
  border-radius:12px !important;
  box-shadow:none !important;
}

/* VOID_THEME_V550 */
:root{
  --ng-blue:#1aa3ff;
  --ng-gold:#ffb000;
  --ng-green:#2dff88;
  --ng-ink:#02040b;
}
html,body{height:100%;}
body{
  background:
    radial-gradient(1200px 700px at 15% 10%, rgba(26,163,255,.25), transparent 60%),
    radial-gradient(900px 600px at 85% 25%, rgba(255,176,0,.18), transparent 55%),
    radial-gradient(700px 520px at 70% 85%, rgba(45,255,136,.10), transparent 60%),
    radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.35), transparent 60%),
    radial-gradient(1px 1px at 60% 50%, rgba(255,255,255,.25), transparent 60%),
    radial-gradient(1px 1px at 80% 70%, rgba(255,255,255,.18), transparent 60%),
    var(--ng-ink);
  color:#eaf3ff;
}
@media (prefers-reduced-motion:no-preference){
  .floaty{animation: floaty 6s ease-in-out infinite;}
  @keyframes floaty{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
}
/* Remove any framed layout constraints */
.container, .wrap, .page, .main{background:transparent !important;border:none !important;box-shadow:none !important;}
/* Hero image: full-bleed, no “card” feel */
img.logo, .logoImg, #logoImg{
  width:min(980px, 100%);
  max-width:100%;
  height:auto;
  display:block;
  margin:0 auto 14px auto;
  border-radius:14px;
  background:transparent;
  box-shadow:
    0 0 0 1px rgba(26,163,255,.22),
    0 0 38px rgba(26,163,255,.18),
    0 0 26px rgba(255,176,0,.10);
}
/* Title glow */
h1, .titleText{
  letter-spacing:.08em;
  text-transform:uppercase;
  background: linear-gradient(180deg, #7fd3ff 0%, #1aa3ff 45%, #0a2a66 100%);
  -webkit-background-clip:text;
  background-clip:text;
  color:transparent;
  text-shadow:
    0 0 18px rgba(26,163,255,.35),
    0 0 28px rgba(26,163,255,.18);
}
/* Sub-title toned blue */
.subtitle, .subTitle, .helperText{
  color: rgba(26,163,255,.85) !important;
}
/* “SIGN IN” neon */
.signInLabel, .labelSignIn, .signinLabel{
  color: var(--ng-green) !important;
  text-shadow: 0 0 12px rgba(45,255,136,.35);
  letter-spacing:.22em;
}
/* Email input: deep blue outline + subtle sparks */
.inputWrap, .emailWrap{
  position:relative;
}
input[type="email"], .emailInput{
  background: rgba(0,0,0,.25) !important;
  border: 2px solid rgba(26,163,255,.9) !important;
  box-shadow: 0 0 18px rgba(26,163,255,.22);
}
.inputWrap:before, .emailWrap:before{
  content:"";
  position:absolute;
  inset:-10px -14px;
  pointer-events:none;
  border-radius:999px;
  background:
    radial-gradient(2px 2px at 10% 35%, rgba(255,255,255,.55), transparent 60%),
    radial-gradient(1px 1px at 35% 20%, rgba(255,176,0,.45), transparent 70%),
    radial-gradient(1px 1px at 80% 65%, rgba(26,163,255,.45), transparent 70%),
    radial-gradient(1px 1px at 55% 80%, rgba(45,255,136,.35), transparent 70%);
  filter: blur(.2px);
  opacity:.55;
}
/* Enter button: outline-only, floating, gold glow */
button.primary, .enterBtn, #enterBtn{
  background: transparent !important;
  border: 2px solid rgba(255,176,0,.95) !important;
  color: rgba(255,176,0,.98) !important;
  box-shadow: 0 0 22px rgba(255,176,0,.18);
  text-shadow: 0 0 14px rgba(255,176,0,.25);
}
button.primary:hover, .enterBtn:hover, #enterBtn:hover{
  box-shadow: 0 0 28px rgba(255,176,0,.28);
}
/* Bottom bar: thinner + logo-like glow */
.bottomBar, .underEnter, .progressBar{
  height: 10px !important;
  border-radius: 999px !important;
  background:
    linear-gradient(90deg, rgba(26,163,255,.0) 0%,
                          rgba(26,163,255,.38) 22%,
                          rgba(255,176,0,.40) 50%,
                          rgba(45,255,136,.22) 78%,
                          rgba(45,255,136,0) 100%) !important;
  box-shadow:
    0 0 22px rgba(26,163,255,.10),
    0 0 18px rgba(255,176,0,.10);
  opacity:.85;
}
/* Version badge: always visible */
#versionBadge{
  position: fixed;
  top: 10px;
  right: 12px;
  z-index: 9999;
  font: 700 12px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color: rgba(255,255,255,.75);
  letter-spacing:.08em;
  padding:6px 10px;
  border-radius: 999px;
  border: 1px solid rgba(26,163,255,.35);
  background: rgba(0,0,0,.22);
  box-shadow: 0 0 18px rgba(26,163,255,.12);
}
</style>
</head>
<body>
<div id="versionBadge">v552</div>

<div id="sweepOverlay" style="display:none">
  <video id="sweepVideo" muted playsinline preload="auto">
    <source src="0217.mp4" type="video/mp4"/>
  </video>
</div>

<div id="modalBg" style="display:none"></div>
<div id="modal" style="display:none"></div>

<div id="app"></div>

<pre id="fatalErr" style="display:none;white-space:pre-wrap;color:#ffb3b3;background:rgba(0,0,0,.55);border:1px solid rgba(255,255,255,.12);padding:12px;border-radius:12px;max-width:820px;margin:12px auto;"></pre>

<script>
// v552: Global error handlers so we NEVER get a blank page with no clue.
(function(){
  function show(msg){
    try{
      var el=document.getElementById("fatalErr");
      if(!el) return;
      el.style.display="block";
      el.textContent="ERROR:\n"+msg;
    }catch(_){ }
  }
  window.addEventListener("error", function(e){ show((e && e.message) ? e.message : String(e)); });
  window.addEventListener("unhandledrejection", function(e){ show((e && e.reason) ? (e.reason.message||String(e.reason)) : "Unhandled rejection"); });
})();

/* ============================
   Config / Helpers
   ============================ */
const BUILD = 552;

const ASSET_BASE = new URL('.', document.baseURI).toString();
const asset = (p)=> new URL(p, ASSET_BASE).toString();

const BANNER_PRIMARY="7F737C26-56A1-497B-A4A2-CCD6141E7B8C.png?v=496";
const BANNER_FALLBACK="7F737C26-56A1-497B-A4A2-CCD6141E7B8C.png?v=496";
const OWNER_EMAIL="stevewmoody@yahoo.com";
const OWNER_NAME="Steve Moody";
const firebaseConfig = {"apiKey": "AIzaSyC0sdB54z0G73P3epW6GmHqgYvESFcqgTo", "authDomain": "gamenightdarts-e7601.firebaseapp.com", "projectId": "gamenightdarts-e7601", "storageBucket": "gamenightdarts-e7601.firebasestorage.app", "messagingSenderId": "270045452251", "appId": "1:270045452251:web:5a4a661140a60780e939fe", "measurementId": "G-M60TDFYBW0"};

const $=(s,r=document)=>r.querySelector(s);

function showError(msg){
  const box=document.getElementById("errBox");
  if(!box) return;
  box.style.display="block";
  box.innerHTML = "<b>Build v552 error:</b>\n"+String(msg);
}
window.addEventListener("error",(e)=>{
  showError(e?.error?.stack || e?.message || e);
});
window.addEventListener("unhandledrejection",(e)=>{
  showError(e?.reason?.stack || e?.reason || e);
});
const store={
  get(k,f=null){try{const v=localStorage.getItem(k);return v?JSON.parse(v):f;}catch{return f;}},
  set(k,v){localStorage.setItem(k,JSON.stringify(v));},
  del(k){localStorage.removeItem(k);}
};

/* ============================
   Local fallback (no-Firebase safety)
   ============================ */
const LOCAL_PLAYERS_KEY="ng_players_v1";
function localGetPlayers(){
  const list = store.get(LOCAL_PLAYERS_KEY, []);
  return Array.isArray(list)?list:[];
}
function localSetPlayers(list){ store.set(LOCAL_PLAYERS_KEY, list); }
function localUpsertPlayer(p){
  const email = normEmail(p.email);
  const name = normName(p.name);
  if(!email || !name) throw new Error("localUpsertPlayer requires email+name");
  const list = localGetPlayers();
  const i = list.findIndex(x=>normEmail(x.email)===email);
  const rec = {email, name, updatedAt: nowMs()};
  if(i>=0) list[i] = {...list[i], ...rec};
  else list.push(rec);
  localSetPlayers(list);
  return rec;
}
function normEmail(e){return String(e||"").trim().toLowerCase();}
function normName(n,email){const v=String(n||"").trim(); return v?v:normEmail(email);}
function getAvatarFor(p){
  const name=(p?.name||"").toLowerCase();
  const email=(p?.email||"").toLowerCase();

  // Repo-confirmed filenames:
  // - MY DART AVATAR.png (Steve)
  // - WILLIAM DART AVATAR.png (Bill/William)
  if(name.includes("steve") || email.includes("stevewmoody")) return "MY DART AVATAR.png";
  if(name.includes("william") || name.includes("bill")) return "WILLIAM DART AVATAR.png";

  // Default for anyone else until their avatar file is added to repo
  return "MY DART AVATAR.png";
}

function nowMs(){return Date.now();}

function setHtml(h){ $("#app").innerHTML=h; }
function footer(){
  return `
    <div class="footer">
      <b>Night Games</b> is owned by <b>The Dart Room</b>. © 2026 The Dart Room. All rights reserved. •
      Designed by <b>Steve’s Graphic Designs</b>.
    </div>
  `;
}
function headerBanner(title="Night Games", opts={}){
  const showTitleBelow = !!opts.titleBelow; // landing: logo above title
  return `
    <div class="header">
      <img class="banner" src="${BANNER_PRIMARY}" alt="Night Games Banner"
        onerror="this.onerror=null; this.src='${BANNER_FALLBACK}';"/>
      <div class="bannerShade"></div>
      ${showTitleBelow ? `
        <div class="titleRow" style="position:relative; left:auto; right:auto; bottom:auto; padding:12px 14px 0 14px;">
          <div class="h1">${title}</div>
          <div class="badge">v552</div>
        </div>
      ` : `
        <div class="titleRow">
          <div class="h1">${title}</div>
          <div class="badge">v552</div>
        </div>
      `}
    </div>
  `;
}
function avatarFor(email,name){
  const e=normEmail(email);
  const n=String(name||"").toLowerCase();
  if(e===normEmail(OWNER_EMAIL)) return "MY DART AVATAR.png";
  if(n.includes("bill moody")||n.includes("william moody")||n.includes("william")) return "WILLIAM DART AVATAR.png";
  if(n.includes("jace")||n.includes("jayce")) return "MY DART AVATAR.png";
  return null;
}

/* ============================
   Sound (speaker button)
   ============================ */
let audioCtx=null;
function soundOn(){return store.get("soundOn", true);}
function setSound(on){store.set("soundOn", !!on);}
function beep(freq=520, ms=45, gain=0.04){
  if(!soundOn()) return;
  try{
    if(!audioCtx) audioCtx=new (window.AudioContext||window.webkitAudioContext)();
    const o=audioCtx.createOscillator();
    const g=audioCtx.createGain();
    o.type="sine"; o.frequency.value=freq;
    g.gain.value=gain;
    o.connect(g); g.connect(audioCtx.destination);
    o.start();
    setTimeout(()=>o.stop(), ms);
  }catch(_){}
}
document.addEventListener("click", (e)=>{
  const btn=e.target.closest("button");
  if(btn) beep();
});

/* ============================
   Modal
   ============================ */
function closeModal(){
  $("#modalBg").classList.remove("show");
  $("#modal").classList.remove("show");
  $("#modal").innerHTML="";
}
function openModal(title, bodyHtml, actionsHtml){
  $("#modal").innerHTML = `
    <div class="modalTitle">${title}</div>
    <div class="modalBody">${bodyHtml}</div>
    <div class="modalActions">${actionsHtml||""}</div>
  `;
  $("#modalBg").classList.add("show");
  $("#modal").classList.add("show");
  $("#modalBg").onclick=closeModal;
}

/* ============================
   Sweep (once)
   ============================ */
function runSweepOnce(){
  const key="sweepShown_v552";
  if(store.get(key,false)) return;

  const ov=$("#sweepOverlay");
  const v=$("#sweepVideo");
  if(!ov||!v) return;

  store.set(key,true);

  ov.classList.add("show");
  ov.classList.add("run");

  try{
    v.loop=false;
    v.currentTime=0;
    v.play().catch(()=>{
      // Autoplay may be blocked; animation still runs.
    });
  }catch(_){}

  const hide=()=>{
    ov.classList.remove("run");
    ov.classList.remove("show");
  };

  // Hide after ~1.6s (animation length). If video ends sooner, also hide.
  v.addEventListener("ended", hide, {once:true});
  setTimeout(hide, 1700);
}
  const done=()=>{
    ov.classList.remove("run");
    ov.classList.remove("show");
  };
  v.addEventListener("ended", done, {once:true});
  setTimeout(done, 2200);
}

/* If autoplay is blocked on some devices, run the sweep on the first user gesture. */
window.addEventListener("pointerdown", ()=>runSweepOnce(), {once:true});
window.addEventListener("keydown", ()=>runSweepOnce(), {once:true});

/* ============================
   Firebase
   ============================ */
let fb={app:null,auth:null,db:null};
function initFirebase(){
  if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);
  fb.app=firebase.app();
  fb.auth=firebase.auth();
  fb.db=firebase.firestore();
}
async function ensureBackendAuth(){
  if(fb.auth.currentUser) return fb.auth.currentUser;
  const cred=await fb.auth.signInAnonymously();
  return cred.user;
}
async function safeInit(){
  try{
    initFirebase();
    await ensureBackendAuth();
    return true;
  }catch(e){
    alert("Firebase init/auth failed:\n\n"+(e?.message||e));
    return false;
  }
}

/* ============================
   Presence (online dot)
   ============================ */
let presenceTimer=null;
let unsubPresence=null;
function startPresence(me){
  if(unsubPresence) unsubPresence();
  if(presenceTimer) clearInterval(presenceTimer);

  const email=normEmail(me.email);
  const ref=fb.db.collection("presence").doc(email);

  async function ping(){
    try{
      await ref.set({
        email,
        name: me.name,
        lastSeenMs: nowMs(),
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
      }, {merge:true});
    }catch(_){}
  }

  ping();
  presenceTimer=setInterval(ping, 25000);

  unsubPresence=fb.db.collection("presence").onSnapshot((snap)=>{
    const m=new Map();
    snap.forEach(doc=>{
      const d=doc.data()||{};
      if(d.email) m.set(normEmail(d.email), d);
    });
    App.presence=m;
    if(App.screen==="players") render();
  });
}
function isOnline(email){
  const p=App.presence.get(normEmail(email));
  if(!p) return false;
  const ms=Number(p.lastSeenMs||0);
  return (nowMs()-ms)<=90000;
}

/* ============================
   App state
   ============================ */
const GAMES=[
  {id:"shanghai", name:"Shanghai"},
  {id:"killer", name:"Killer"},
  {id:"around", name:"Around the World"},
  {id:"cricket", name:"Cricket"},
  {id:"01", name:"01"},
];

const App={
  screen:"auth",
  me:null,
  players:[],
  presence:new Map(),
  matches:[],
  match:null,
  matchId:null,
  unsubMatches:null,
  unsubMatch:null,
  params:{},
};

function go(screen, params={}){
  App.screen=screen;
  App.params=params||{};
  render();
}

function topbar(){
  const sOn=soundOn();
  return `
    <div class="topbar">
      <div>
        <div class="bigName">${App.me?.name||""}</div>
        <div class="sub">${App.me?.email||""}</div>
      </div>
      <div class="row">
        <button class="btn sm" id="btnSpeaker">${sOn?"🔊":"🔇"}</button>
        <button class="btn sm" id="btnPlayers">Players</button>
        <button class="btn sm danger" id="btnSignOut">Sign out</button>
      </div>
    </div>
  `;
}

/* ============================
   Players collection
   ============================ */
async function ensureOwner(){
  try{
    await fb.db.collection("players").doc(normEmail(OWNER_EMAIL)).set({
      email:normEmail(OWNER_EMAIL),
      name:OWNER_NAME,
      locked:true,
      updatedAt: firebase.firestore.FieldValue.serverTimestamp()
    }, {merge:true});
  }catch(_){}
}
async function loadPlayers(){
  try{
    // Prefer Firebase if available
    if(!fb?.db) throw new Error("Firebase not ready");
    const snap=await fb.db.collection("players").get();
    App.players=snap.docs.map(d=>d.data()).filter(Boolean).map(p=>({
      email:normEmail(p.email),
      name:normName(p.name),
      createdAt:p.createdAt||null,
      updatedAt:p.updatedAt||null,
      locked:!!p.locked
    }));
  }catch(e){
    // Local fallback so ENTER always works even if Firebase fails
    App.players = localGetPlayers().map(p=>({
      email:normEmail(p.email),
      name:normName(p.name),
      createdAt:p.createdAt||null,
      updatedAt:p.updatedAt||null,
      locked:!!p.locked
    }));
  }
}

async function upsertPlayer(email,name){
  email=normEmail(email); name=normName(name,email);
  const payload={email,name, updatedAt: nowMs()};
  try{
    if(!fb?.db) throw new Error("Firebase not ready");
    await fb.db.collection("players").doc(email).set({
      ...payload,
      createdAt: firebase.firestore.FieldValue.serverTimestamp()
    }, {merge:true});
    return {email,name};
  }catch(e){
    // Local fallback
    return localUpsertPlayer({email,name});
  }
}


/* ============================
   Matches (no codes)
   ============================ */
function randId(len=18){
  const chars="abcdefghijklmnopqrstuvwxyz0123456789";
  let s="";
  for(let i=0;i<len;i++) s+=chars[Math.floor(Math.random()*chars.length)];
  return s;
}
function subscribeMatches(){
  if(App.unsubMatches) App.unsubMatches();
  App.unsubMatches=fb.db.collection("matches")
    .orderBy("createdAtMs","desc")
    .limit(25)
    .onSnapshot((snap)=>{
      const list=[];
      snap.forEach(doc=>{
        const d=doc.data()||{};
        if(d.status==="open" || d.status==="active"){
          d.matchId=doc.id;
          list.push(d);
        }
      });
      App.matches=list;
      if(App.screen==="player") render();
    });
}
function subscribeMatch(matchId){
  if(App.unsubMatch) App.unsubMatch();
  App.unsubMatch=fb.db.collection("matches").doc(matchId).onSnapshot((doc)=>{
    if(!doc.exists){
      App.match=null; App.matchId=null;
      if(App.screen.startsWith("game_")) go("player");
      return;
    }
    App.match=doc.data()||{};
    App.matchId=matchId;
    if(App.screen.startsWith("game_")) render();
  });
}

function matchTitle(gameId, settings){
  if(gameId==="01"){
    const base=settings.base||501;
    const inMode=settings.inMode||"straight";
    const outMode=settings.outMode||"double";
    return `01 • ${base} • ${inMode}-in/${outMode}-out`;
  }
  if(gameId==="cricket") return "Cricket • Standard";
  return `${(GAMES.find(g=>g.id===gameId)?.name)||gameId}`;
}

function initGameState(gameId, settings, seats){
  if(gameId==="01"){
    const base = Number(settings.base||501);
    const leftBySeat={};
    seats.forEach(s=>{ leftBySeat[s.seat]=base; });
    return {leftBySeat, winnerSeat:null};
  }
  if(gameId==="cricket"){
    const keys=["20","19","18","17","16","15","B"];
    const marks={};
    const score={};
    seats.forEach(s=>{
      marks[s.seat]={};
      keys.forEach(k=>marks[s.seat][k]=0);
      score[s.seat]=0;
    });
    return {marks, score, winnerSeat:null};
  }
  return {note:"placeholder", winnerSeat:null};
}

async function createMatch(gameId, settings, seatCount=2){
  const matchId=randId(20);
  const seats=[];
  for(let i=0;i<seatCount;i++){
    seats.push({seat:i+1, email:"", name:""});
  }
  // creator claims seat 1
  seats[0]={seat:1, email:App.me.email, name:App.me.name};

  await fb.db.collection("matches").doc(matchId).set({
    status:"open",
    createdAtMs: nowMs(),
    updatedAtMs: nowMs(),
    createdBy: App.me.email,
    title: matchTitle(gameId, settings),
    gameId,
    settings,
    seats,
    turnSeat: settings.startingSeat||1,
    turnEmail: (settings.startingSeat||1)===1 ? App.me.email : "",
    state: initGameState(gameId, settings, seats),
    log: []
  });

  subscribeMatch(matchId);
  go("game_"+gameId, {matchId});
}

async function claimSeat(matchId, seatNum){
  const ref=fb.db.collection("matches").doc(matchId);
  await fb.db.runTransaction(async (tx)=>{
    const snap=await tx.get(ref);
    if(!snap.exists) throw new Error("Match not found.");
    const m=snap.data()||{};
    const seats=(m.seats||[]).map(s=>({...s}));
    const seat=seats.find(s=>Number(s.seat)===Number(seatNum));
    if(!seat) throw new Error("Seat not found.");
    if(seat.email && normEmail(seat.email)!==normEmail(App.me.email)){
      throw new Error("Seat already taken.");
    }
    seat.email=App.me.email;
    seat.name=App.me.name;

    // if match has no turnEmail yet, set it to first seat's email
    let turnSeat=m.turnSeat||1;
    let turnEmail=m.turnEmail||"";
    const ts=seats.find(s=>Number(s.seat)===Number(turnSeat));
    if(ts && ts.email) turnEmail=ts.email;

    tx.update(ref, {seats, status:"active", turnSeat, turnEmail, updatedAtMs: nowMs()});
  });
}

function mySeat(m){
  const email=normEmail(App.me?.email);
  return (m.seats||[]).find(s=>normEmail(s.email)===email)?.seat || null;
}
function isMyTurn(m){
  return normEmail(m.turnEmail)===normEmail(App.me?.email);
}

/* ============================
   Game actions
   ============================ */
async function submit01(matchId, points){
  const ref=fb.db.collection("matches").doc(matchId);
  await fb.db.runTransaction(async (tx)=>{
    const snap=await tx.get(ref);
    if(!snap.exists) throw new Error("Match not found.");
    const m=snap.data()||{};
    if(normEmail(m.turnEmail)!==normEmail(App.me.email)) throw new Error("Not your turn.");
    const seat=mySeat(m);
    if(!seat) throw new Error("You are not seated in this match.");

    const pts=Math.max(0, Math.min(180, Number(points||0)));
    const state=m.state||{};
    const leftBySeat={...(state.leftBySeat||{})};
    const left=Number(leftBySeat[seat]||0);
    const newLeft=left-pts;

    let appliedLeft=left;
    let winnerSeat=state.winnerSeat||null;

    if(newLeft===0){
      appliedLeft=0; winnerSeat=seat;
    }else if(newLeft>0){
      appliedLeft=newLeft;
    } // else bust => no change

    leftBySeat[seat]=appliedLeft;

    const seats=m.seats||[];
    const ordered=seats.map(s=>Number(s.seat)).sort((a,b)=>a-b);
    let idx=ordered.indexOf(Number(m.turnSeat)); if(idx<0) idx=0;
    let nextSeat=ordered[(idx+1)%ordered.length];
    if(winnerSeat) nextSeat=seat;

    const nextSeatObj=seats.find(s=>Number(s.seat)===Number(nextSeat))||{};
    const nextEmail=nextSeatObj.email||"";

    const log=(m.log||[]).slice(0,300);
    log.unshift({t:nowMs(), game:"01", seat, name:App.me.name, email:App.me.email, pts, leftBefore:left, leftAfter:appliedLeft});

    tx.update(ref, {
      state:{...state, leftBySeat, winnerSeat},
      turnSeat: nextSeat,
      turnEmail: nextEmail,
      status:"active",
      updatedAtMs: nowMs(),
      log
    });
  });
}

async function submitCricket(matchId, marksThisTurn){
  const ref=fb.db.collection("matches").doc(matchId);
  await fb.db.runTransaction(async (tx)=>{
    const snap=await tx.get(ref);
    if(!snap.exists) throw new Error("Match not found.");
    const m=snap.data()||{};
    if(normEmail(m.turnEmail)!==normEmail(App.me.email)) throw new Error("Not your turn.");
    const seat=mySeat(m);
    if(!seat) throw new Error("You are not seated in this match.");

    const state=m.state||{};
    const marks=JSON.parse(JSON.stringify(state.marks||{}));
    const score={...(state.score||{})};
    const keys=["20","19","18","17","16","15","B"];

    let totalAdded=0;
    keys.forEach(k=>{
      const add=Math.max(0, Math.min(3, Number(marksThisTurn[k]||0)));
      totalAdded+=add;
      if(!marks[seat]) marks[seat]={};
      marks[seat][k]=Number(marks[seat][k]||0)+add;
    });

    const val={"20":20,"19":19,"18":18,"17":17,"16":16,"15":15,"B":25};
    let gained=0;
    keys.forEach(k=>{
      const before = Number(state.marks?.[seat]?.[k]||0);
      const after = Number(marks[seat][k]||0);
      const beforeOver=Math.max(0, before-3);
      const afterOver=Math.max(0, after-3);
      const inc=afterOver-beforeOver;
      if(inc>0) gained += inc*val[k];
    });
    score[seat]=Number(score[seat]||0)+gained;

    let winnerSeat=state.winnerSeat||null;
    const closedAll = keys.every(k=>Number(marks[seat][k]||0)>=3);
    if(closedAll){
      let maxOther=0;
      Object.keys(score).forEach(s=>{
        if(Number(s)!==Number(seat)) maxOther=Math.max(maxOther, Number(score[s]||0));
      });
      if(Number(score[seat]||0)>=maxOther) winnerSeat=seat;
    }

    const seats=m.seats||[];
    const ordered=seats.map(s=>Number(s.seat)).sort((a,b)=>a-b);
    let idx=ordered.indexOf(Number(m.turnSeat)); if(idx<0) idx=0;
    let nextSeat=ordered[(idx+1)%ordered.length];
    if(winnerSeat) nextSeat=seat;

    const nextSeatObj=seats.find(s=>Number(s.seat)===Number(nextSeat))||{};
    const nextEmail=nextSeatObj.email||"";

    const log=(m.log||[]).slice(0,300);
    log.unshift({t:nowMs(), game:"cricket", seat, name:App.me.name, email:App.me.email, totalMarks:totalAdded, gained, scoreAfter:score[seat]});

    tx.update(ref, {
      state:{...state, marks, score, winnerSeat},
      turnSeat: nextSeat,
      turnEmail: nextEmail,
      status:"active",
      updatedAtMs: nowMs(),
      log
    });
  });
}

/* ============================
   Screens
   ============================ */

async function onStart(){
  try{
    const inEl=$("#inEmail");
    const email = normEmail((inEl?.value || ""));
    if(inEl) inEl.value=""; // auto-clear so next person never sees the previous email
    if(!email){
      alert("Enter your email.");
      return;
    }

    // Try Firebase, but never block the app if it fails.
    try{ await safeInit(); }catch(e){ /* fall back to local */ }

    // load players and find existing (falls back to local automatically)
    await loadPlayers();
    let p = (App.players||[]).find(x=>normEmail(x.email)===email);

    if(!p){
      const nameRaw = prompt("New player. Enter your name:");
      const name = normName(nameRaw||"");
      if(!name){
        alert("Name is required for a new player.");
        return;
      }
      p = await upsertPlayer({email, name});
      await loadPlayers();
    }

    // remember for convenience (but landing still shows first by design in this build series)
    store.set("me", {email: p.email, name: p.name, ts: nowMs()});

    App.me = p;
    go("player");
  }catch(err){
    showError(err);
  }
}

function screenAuth(){
  setHtml(`
    <div class="header heroHeader">
      <div class="heroInner">
        <img class="heroLogo" src="./7F737C26-56A1-497B-A4A2-CCD6141E7B8C.png" alt="Night Games"
          onerror="this.style.display='none'"/>
        <div class="heroText">
          <div class="heroNight">NIGHT</div>
          <div class="heroGames">GAMES</div>
        </div>
      </div>
    </div>

    <div class="main">
      <div class="heroPanel open">
        <div class="h2">Sign in</div>
        <div style="height:10px"></div>

        <div class="sparkField">
          <input id="inEmail" class="input inputEmail" placeholder="you@example.com" autocomplete="email" inputmode="email"/>
        </div>

        <div style="height:12px"></div>
        <button id="btnEnter" type="button" class="btn btnEnter glass">Enter</button>

        <div class="sparkBar" aria-hidden="true"></div>
      </div>
    </div>
    ${footer()}
  `);

  $("#btnEnter").onclick=onStart;
  $("#inEmail").addEventListener("keydown",(e)=>{ if(e.key==="Enter") onStart(); });
}function renderPlayersUnderGames(){
  const host=$("#playersUnderGames");
  if(!host) return;
  const players=[...(App.players||[])].sort((a,b)=>a.name.localeCompare(b.name)).slice(0,8);
  host.innerHTML = players.map(p=>{
    const online=isOnline(p.email);
    const av=avatarFor(p.email,p.name);
    return `
      <div class="playerRow">
        <div class="left">
          <span class="dot ${online?"on":""}"></span>
          <div class="nameWithAvatar">
            ${av?`<img src="${av}" alt="avatar" onerror="this.style.display='none'"/>`:""}
            <div class="pmeta">
              <div class="pname">${p.name}${p.locked?' <span class="chip">owner</span>':""}</div>
              <div class="pemail">${p.email}</div>
            </div>
          </div>
        </div>
        <div class="row">
          <span class="chip">${online?"online":"offline"}</span>
        </div>
      </div>
    `;
  }).join("");
}
function renderMatchesList(){
  const host=$("#matches");
  if(!host) return;
  const list=App.matches||[];

  if(list.length===0){
    host.innerHTML = `<div class="sub">No open matches yet.</div>`;
    return;
  }

  host.innerHTML = list.map(m=>{
    const seats=m.seats||[];
    const taken=seats.filter(s=>s.email).length;
    const online = seats.some(s=>s.email && isOnline(s.email));
    return `
      <div class="playerRow">
        <div class="left">
          <span class="dot ${online?"on":""}"></span>
          <div class="pmeta" style="min-width:0">
            <div class="pname">${m.title||m.gameId||"Match"}</div>
            <div class="pemail">${taken}/${seats.length} seated • ${m.status}</div>
          </div>
        </div>
        <div class="row">
          <button class="btn sm" data-open="${m.matchId}">Open</button>
        </div>
      </div>
    `;
  }).join("");

  host.querySelectorAll("button[data-open]").forEach(btn=>{
    btn.onclick=()=>{
      const id=btn.getAttribute("data-open");
      subscribeMatch(id);
      const m=App.matches.find(x=>x.matchId===id);
      const gameId=m?.gameId || "01";
      go("game_"+gameId, {matchId:id, gameId});
    };
  });
}

function screenPlayers(){
  setHtml(`
    ${headerBanner("Players")}
    <div class="main">
      ${topbar()}
      <div style="height:12px"></div>

      <div class="panel">
        <div class="row space">
          <h3 class="h2" style="margin:0">Players</h3>
          <button class="btn sm" id="btnBack">Back</button>
        </div>
        <div class="sub">Green dot means online (last ping within 90 seconds).</div>
        <div style="height:10px"></div>
        <div id="plist" class="list"></div>
      </div>
    </div>
    ${footer()}
  `);

  $("#btnSpeaker").onclick=()=>{ setSound(!soundOn()); render(); };
  $("#btnPlayers").onclick=()=>go("players");
  $("#btnSignOut").onclick=()=>signOut();
  $("#btnBack").onclick=()=>go("player");

  const plist=$("#plist");
  const players=[...App.players].sort((a,b)=>a.name.localeCompare(b.name));
  plist.innerHTML = players.map(p=>{
    const av=avatarFor(p.email,p.name);
    const online=isOnline(p.email);
    return `
      <div class="playerRow">
        <div class="left">
          <span class="dot ${online?"on":""}"></span>
          <div class="nameWithAvatar">
            ${av?`<img src="${av}" alt="avatar" onerror="this.style.display='none'"/>`:""}
            <div class="pmeta">
              <div class="pname">${p.name}${p.locked?' <span class="chip">owner</span>':""}</div>
              <div class="pemail">${p.email}</div>
            </div>
          </div>
        </div>
        <div class="row">
          <span class="chip">${online?"online":"offline"}</span>
        </div>
      </div>
    `;
  }).join("");
}


function screenHistory(){
  const gameId=App.params.gameId;
  const g=GAMES.find(x=>x.id===gameId) || {id:gameId,name:gameId};
  setHtml(`
    ${headerBanner("Game History")}
    <div class="main">
      ${topbar()}
      <div style="height:12px"></div>
      <div class="panel">
        <div class="row space">
          <h3 class="h2" style="margin:0">${g.name} • Game History</h3>
          <button class="btn sm" id="btnBack">Back</button>
        </div>
        <div style="height:10px"></div>
        <div class="ok">History view is wired as a real page in v552. Next pass we populate it from match logs / saved games.</div>
      </div>
    </div>
    ${footer()}
  `);
  $("#btnSpeaker").onclick=()=>{ setSound(!soundOn()); render(); };
  $("#btnPlayers").onclick=()=>go("players");
  $("#btnSignOut").onclick=()=>signOut();
  $("#btnBack").onclick=()=>go("player");
}

function screenStats(){
  const gameId=App.params.gameId;
  const g=GAMES.find(x=>x.id===gameId) || {id:gameId,name:gameId};
  setHtml(`
    ${headerBanner("Stats")}
    <div class="main">
      ${topbar()}
      <div style="height:12px"></div>
      <div class="panel">
        <div class="row space">
          <h3 class="h2" style="margin:0">${g.name} • Stats</h3>
          <button class="btn sm" id="btnBack">Back</button>
        </div>
        <div style="height:10px"></div>
        <div class="ok">Stats page is a real page in v552. Next pass we show the stat definitions + your notables.</div>
      </div>
    </div>
    ${footer()}
  `);
  $("#btnSpeaker").onclick=()=>{ setSound(!soundOn()); render(); };
  $("#btnPlayers").onclick=()=>go("players");
  $("#btnSignOut").onclick=()=>signOut();
  $("#btnBack").onclick=()=>go("player");
}

function screenGameSetup(){
  const gameId=App.params.gameId;
  const g=GAMES.find(x=>x.id===gameId) || {id:gameId,name:gameId};
  const is01 = gameId==="01";
  const isCricket = gameId==="cricket";

  setHtml(`
    ${headerBanner(g.name)}
    <div class="main">
      ${topbar()}
      <div style="height:12px"></div>

      <div class="panel">
        <div class="row space">
          <h3 class="h2" style="margin:0">${g.name} setup</h3>
          <button class="btn sm" id="btnBack">Back</button>
        </div>
        <div class="sub">Pick 2 players and choose who starts (manual or random).</div>
        <div style="height:12px"></div>

        <div class="grid">
          <div class="panel">
            <h3 class="h2">Players (2)</h3>
            <div class="sub">Teams come next pass. This first full run keeps it simple.</div>
            <div style="height:10px"></div>
            <select id="p1" class="input"></select>
            <div style="height:10px"></div>
            <select id="p2" class="input"></select>
            <div style="height:10px"></div>
            <button class="btn" id="btnRandomStart">Random who starts</button>
            <div class="sub" id="startInfo" style="margin-top:8px;"></div>
          </div>

          <div class="panel">
            <h3 class="h2">Options</h3>
            ${is01?`
              <div class="sub">Pick 301 / 501 / 701 and in/out options.</div>
              <div style="height:10px"></div>
              <select id="base" class="input">
                <option value="301">301</option>
                <option value="501" selected>501</option>
                <option value="701">701</option>
              </select>
              <div style="height:10px"></div>
              <select id="inMode" class="input">
                <option value="straight" selected>Straight in</option>
                <option value="double">Double in</option>
              </select>
              <div style="height:10px"></div>
              <select id="outMode" class="input">
                <option value="double" selected>Double out</option>
                <option value="straight">Straight out</option>
              </select>
            `: isCricket?`
              <div class="ok">Cricket standard numbers 20–15 + bull.</div>
            `:`
              <div class="ok">Placeholder screen included so the build is complete.</div>
            `}
            <div style="height:12px"></div>
            <button class="btn green pulse" id="btnCreate">Create match</button>
          </div>
        </div>
      </div>
    </div>
    ${footer()}
  `);

  $("#btnSpeaker").onclick=()=>{ setSound(!soundOn()); render(); };
  $("#btnPlayers").onclick=()=>go("players");
  $("#btnSignOut").onclick=()=>signOut();
  $("#btnBack").onclick=()=>go("player");

  const players=[...App.players].sort((a,b)=>a.name.localeCompare(b.name));
  const options=players.map(p=>`<option value="${p.email}">${p.name} (${p.email})</option>`).join("");
  $("#p1").innerHTML=options;
  $("#p2").innerHTML=options;

  const meEmail=normEmail(App.me.email);
  $("#p1").value=meEmail;
  const other=players.find(p=>p.email!==meEmail) || players[0];
  $("#p2").value=other.email;

  let startingSeat=1;
  const updateStartInfo=()=>{
    const p1=$("#p1").value; const p2=$("#p2").value;
    const n1=players.find(p=>p.email===p1)?.name||p1;
    const n2=players.find(p=>p.email===p2)?.name||p2;
    const startName = startingSeat===1?n1:n2;
    $("#startInfo").textContent = "Starts first: " + startName;
  };
  updateStartInfo();

  $("#btnRandomStart").onclick=()=>{ startingSeat = (Math.random()<0.5)?1:2; updateStartInfo(); };
  $("#p1").onchange=updateStartInfo;
  $("#p2").onchange=updateStartInfo;

  $("#btnCreate").onclick=async ()=>{
    const p1=$("#p1").value;
    const p2=$("#p2").value;
    if(p1===p2){ alert("Pick two different players."); return; }

    const n1=players.find(p=>p.email===p1)?.name||p1;
    const n2=players.find(p=>p.email===p2)?.name||p2;

    // settings
    const settings = is01 ? {
      base:Number($("#base").value),
      inMode:$("#inMode").value,
      outMode:$("#outMode").value,
      startingSeat
    } : {startingSeat};

    // create match, then set seat 2 to chosen player if it's you; otherwise it's open and they join
    try{
      await createMatch(gameId, settings, 2);
      // after create, we can set seat2 to the selected opponent immediately (so it feels like your old builds)
      const matchId=App.matchId;
      const ref=fb.db.collection("matches").doc(matchId);
      await fb.db.runTransaction(async (tx)=>{
        const snap=await tx.get(ref);
        if(!snap.exists) return;
        const m=snap.data()||{};
        const seats=(m.seats||[]).map(s=>({...s}));
        seats[0]={seat:1,email:p1,name:n1};
        seats[1]={seat:2,email:p2,name:n2};
        // set turn email to starting seat email
        const ts=seats.find(s=>Number(s.seat)===Number(startingSeat));
        tx.update(ref, {seats, turnSeat:startingSeat, turnEmail:ts?.email||"", status:"active", updatedAtMs: nowMs()});
      });
      subscribeMatch(matchId);
      go("game_"+gameId, {matchId});
    }catch(e){
      alert("Could not create match:\n\n"+(e?.message||e));
    }
  };
}

function screenGameCricket(){
  const m=App.match;
  if(!m){ go("player"); return; }

  const seats=m.seats||[];
  const seatMe=mySeat(m);
  const myTurn=isMyTurn(m);
  const winner=m.state?.winnerSeat || null;

  const scoreRows=seats.map(s=>{
    const online=isOnline(s.email);
    const isTurn = Number(m.turnSeat)===Number(s.seat);
    const sc=Number(m.state?.score?.[s.seat]||0);
    const closedAll = ["20","19","18","17","16","15","B"].every(k=>Number(m.state?.marks?.[s.seat]?.[k]||0)>=3);
    return `
      <div class="playerRow">
        <div class="left">
          <span class="dot ${online?"on":""}"></span>
          <div class="pmeta">
            <div class="pname">${s.name} ${isTurn?'<span class="chip">turn</span>':""} ${winner===s.seat?'<span class="chip">winner</span>':""}</div>
            <div class="pemail">${s.email}</div>
          </div>
        </div>
        <div class="row">
          <span class="chip">Score: ${sc}</span>
          <span class="chip">${closedAll?"closed":"open"}</span>
        </div>
      </div>
    `;
  }).join("");

  const keys=["20","19","18","17","16","15","B"];
  const marksTable = `
    <table class="table">
      <thead><tr><th>Number</th>${seats.map(s=>`<th>${s.name}</th>`).join("")}</tr></thead>
      <tbody>
        ${keys.map(k=>`
          <tr>
            <td>${k==="B"?"Bull":k}</td>
            ${seats.map(s=>{
              const v=Number(m.state?.marks?.[s.seat]?.[k]||0);
              const show = v>=3 ? ("✔ "+v) : String(v);
              return `<td>${show}</td>`;
            }).join("")}
          </tr>
        `).join("")}
      </tbody>
    </table>
  `;

  setHtml(`
    ${headerBanner("Cricket")}
    <div class="main">
      ${topbar()}
      <div style="height:12px"></div>

      <div class="panel">
        <div class="row space">
          <h3 class="h2" style="margin:0">${m.title||"Cricket"}</h3>
          <div class="row">
            <button class="btn sm" id="btnBack">Back</button>
          </div>
        </div>
        <div class="sub">v552: Enter marks-per-turn (0–3 each). Scoring is simplified for this first full run.</div>
        <div style="height:12px"></div>

        ${winner?`<div class="ok"><b>Winner:</b> ${seats.find(s=>s.seat===winner)?.name||winner}</div><div style="height:10px"></div>`:""}

        <div class="grid">
          <div class="panel">
            <h3 class="h2">Players</h3>
            <div style="height:10px"></div>
            ${scoreRows}
          </div>
          <div class="panel">
            <h3 class="h2">Board</h3>
            <div style="height:10px"></div>
            ${marksTable}
          </div>
        </div>

        <div style="height:12px"></div>
        <div class="grid">
          <div class="panel">
            <h3 class="h2">Your turn controls</h3>
            ${myTurn?`
              <div class="sub">Enter marks for this turn (0–3 each).</div>
              <div style="height:10px"></div>
              ${keys.map(k=>`
                <div class="row" style="justify-content:space-between;margin-bottom:8px">
                  <div class="chip">${k==="B"?"Bull":k}</div>
                  <input class="input" style="width:120px" type="number" min="0" max="3" value="0" id="mk_${k}"/>
                </div>
              `).join("")}
              <button class="btn green pulse" id="btnSubmit">Submit turn</button>
            `:`
              <div class="lock">Not your turn. Waiting for <b>${m.turnEmail||"other player"}</b>.</div>
            `}
          </div>
          <div class="panel">
            <h3 class="h2">Match log</h3>
            <div class="sub">Latest first</div>
            <div style="height:10px"></div>
            <div id="log"></div>
          </div>
        </div>

      </div>
    </div>
    ${footer()}
  `);

  $("#btnSpeaker").onclick=()=>{ setSound(!soundOn()); render(); };
  $("#btnPlayers").onclick=()=>go("players");
  $("#btnSignOut").onclick=()=>signOut();
  $("#btnBack").onclick=()=>go("player");

  if(!seatMe){
    openModal("Join match", `
      <div class="sub">Pick a seat.</div>
      <div style="height:10px"></div>
      ${seats.map(s=>`
        <button class="btn" data-seat="${s.seat}">Seat ${s.seat}: ${s.email?`${s.name}`:"(open)"}</button>
      `).join('<div style="height:8px"></div>')}
    `, `<button class="btn sm" id="mClose">Close</button>`);
    $("#mClose").onclick=closeModal;
    $("#modal").querySelectorAll("button[data-seat]").forEach(b=>{
      b.onclick=async ()=>{
        const seat=Number(b.getAttribute("data-seat"));
        try{ await claimSeat(App.matchId, seat); closeModal(); }
        catch(e){ alert(e?.message||e); }
      };
    });
  }

  const btn=$("#btnSubmit");
  if(btn){
    btn.onclick=async ()=>{
      const payload={};
      keys.forEach(k=> payload[k]=Number($("#mk_"+k).value||0));
      try{ await submitCricket(App.matchId, payload); }
      catch(e){ alert(e?.message||e); }
    };
  }

  const logHost=$("#log");
  const log=(m.log||[]).slice(0,20);
  logHost.innerHTML = log.length? log.map(x=>`
    <div class="sub">• ${new Date(x.t).toLocaleTimeString()} — ${x.name} (${x.game}) marks:${x.totalMarks}, +${x.gained} pts</div>
  `).join("") : `<div class="sub">No turns yet.</div>`;
}

function screenGame01(){
  const m=App.match;
  if(!m){ go("player"); return; }

  const seats=m.seats||[];
  const seatMe=mySeat(m);
  const myTurn=isMyTurn(m);
  const winner=m.state?.winnerSeat || null;

  const rows=seats.map(s=>{
    const online=isOnline(s.email);
    const isTurn = Number(m.turnSeat)===Number(s.seat);
    const left=Number(m.state?.leftBySeat?.[s.seat]||0);
    return `
      <div class="playerRow">
        <div class="left">
          <span class="dot ${online?"on":""}"></span>
          <div class="pmeta">
            <div class="pname">${s.name} ${isTurn?'<span class="chip">turn</span>':""} ${winner===s.seat?'<span class="chip">winner</span>':""}</div>
            <div class="pemail">${s.email}</div>
          </div>
        </div>
        <div class="row">
          <span class="chip">Left: ${left}</span>
        </div>
      </div>
    `;
  }).join("");

  setHtml(`
    ${headerBanner("01")}
    <div class="main">
      ${topbar()}
      <div style="height:12px"></div>

      <div class="panel">
        <div class="row space">
          <h3 class="h2" style="margin:0">${m.title||"01"}</h3>
          <div class="row">
            <button class="btn sm" id="btnBack">Back</button>
          </div>
        </div>
        <div class="sub">v552: per-turn points entry (0–180). Exact 0 wins. Enforcement of double-in/out comes next pass.</div>
        <div style="height:12px"></div>

        ${winner?`<div class="ok"><b>Winner:</b> ${seats.find(s=>s.seat===winner)?.name||winner}</div><div style="height:10px"></div>`:""}

        <div class="grid">
          <div class="panel">
            <h3 class="h2">Players</h3>
            <div style="height:10px"></div>
            ${rows}
          </div>

          <div class="panel">
            <h3 class="h2">Your turn controls</h3>
            ${myTurn?`
              <div class="sub">Enter points scored this turn (0–180).</div>
              <div style="height:10px"></div>
              <input id="pts" class="input" type="number" min="0" max="180" value="60"/>
              <div style="height:10px"></div>
              <button class="btn green pulse" id="btnSubmit">Submit turn</button>
            `:`
              <div class="lock">Not your turn. Waiting for <b>${m.turnEmail||"other player"}</b>.</div>
            `}
            <div style="height:10px"></div>
            <div class="sub">Settings: ${m.settings?.base||501} • ${m.settings?.inMode||"straight"}-in / ${m.settings?.outMode||"double"}-out</div>
          </div>
        </div>

        <div style="height:12px"></div>
        <div class="panel">
          <h3 class="h2">Match log</h3>
          <div class="sub">Latest first</div>
          <div style="height:10px"></div>
          <div id="log"></div>
        </div>

      </div>
    </div>
    ${footer()}
  `);

  $("#btnSpeaker").onclick=()=>{ setSound(!soundOn()); render(); };
  $("#btnPlayers").onclick=()=>go("players");
  $("#btnSignOut").onclick=()=>signOut();
  $("#btnBack").onclick=()=>go("player");

  if(!seatMe){
    openModal("Join match", `
      <div class="sub">Pick a seat.</div>
      <div style="height:10px"></div>
      ${seats.map(s=>`
        <button class="btn" data-seat="${s.seat}">Seat ${s.seat}: ${s.email?`${s.name}`:"(open)"}</button>
      `).join('<div style="height:8px"></div>')}
    `, `<button class="btn sm" id="mClose">Close</button>`);
    $("#mClose").onclick=closeModal;
    $("#modal").querySelectorAll("button[data-seat]").forEach(b=>{
      b.onclick=async ()=>{
        const seat=Number(b.getAttribute("data-seat"));
        try{ await claimSeat(App.matchId, seat); closeModal(); }
        catch(e){ alert(e?.message||e); }
      };
    });
  }

  const btn=$("#btnSubmit");
  if(btn){
    btn.onclick=async ()=>{
      const pts=Number($("#pts").value||0);
      try{ await submit01(App.matchId, pts); }
      catch(e){ alert(e?.message||e); }
    };
  }

  const logHost=$("#log");
  const log=(m.log||[]).slice(0,25);
  logHost.innerHTML = log.length? log.map(x=>`
    <div class="sub">• ${new Date(x.t).toLocaleTimeString()} — ${x.name}: ${x.pts} (left ${x.leftBefore} → ${x.leftAfter})</div>
  `).join("") : `<div class="sub">No turns yet.</div>`;
}

function screenGamePlaceholder(){
  const gameId=App.params.gameId;
  const g=GAMES.find(x=>x.id===gameId) || {id:gameId,name:gameId};
  setHtml(`
    ${headerBanner(g.name)}
    <div class="main">
      ${topbar()}
      <div style="height:12px"></div>

      <div class="panel">
        <div class="row space">
          <h3 class="h2" style="margin:0">${g.name}</h3>
          <button class="btn sm" id="btnBack">Back</button>
        </div>
        <div style="height:10px"></div>
        <div class="ok">This game screen is included so the build is complete start-to-finish. We wire full rules after Cricket + 01.</div>
      </div>
    </div>
    ${footer()}
  `);

  $("#btnSpeaker").onclick=()=>{ setSound(!soundOn()); render(); };
  $("#btnPlayers").onclick=()=>go("players");
  $("#btnSignOut").onclick=()=>signOut();
  $("#btnBack").onclick=()=>go("player");
}

/* ============================
   Render router
   ============================ */
function render(){
  if(App.screen==="auth") return screenAuth();
  if(App.screen==="player") return screenPlayer();
  if(App.screen==="players") return screenPlayers();
  if(App.screen==="game_setup") return screenGameSetup();
  if(App.screen==="history") return screenHistory();
  if(App.screen==="stats") return screenStats();

  if(App.screen.startsWith("game_")){
    const id=App.screen.replace("game_","");
    if(id==="cricket") return screenGameCricket();
    if(id==="01") return screenGame01();
    return screenGamePlaceholder();
  }

  screenAuth();
}

/* ============================
   Boot
   ============================ */
(async function boot(){
  render();

  // Always start on landing/email gate. Prefill saved email only.
  const remembered=store.get("me", null);
  if(remembered?.email && App.screen==="auth"){
    const inEl=document.getElementById("inEmail");
    if(inEl) inEl.value = remembered.email;
  }

  // Try the diagonal sweep once on landing (may be blocked until user gesture).
  // If blocked, it will run on the first click.
  setTimeout(()=>runSweepOnce(), 350);
})();
// small refresh to keep match list fresh while on player screen
setInterval(()=>{
  if(App.screen==="player") renderMatchesList();
}, 2000);

</script>
</body>
</html>
